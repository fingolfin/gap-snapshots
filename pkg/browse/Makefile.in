# makefile prototype for the Browse package                    Frank LÃ¼beck

GAPPATH=@GAPPATH@

GAP = $(GAPPATH)/gap -b -r -l $(GAPPATH)

GAPINCL=-I$(GAPPATH)/src -I$(GAPPATH)/bin/@GAPARCH@

PKGROOT=$(shell pwd)

LOPTS=$(LDFLAGS) $(GAP_LIBS) -lpanel -lncurses

.PHONY: clean doc test

default:  bin/@GAPARCH@/ncurses.so

bin/@GAPARCH@/ncurses.so: src/ncurses.c Makefile
	mkdir -p bin/@GAPARCH@
	$(GAPPATH)/gac -p "$(CFLAGS)" -d -o \
	     bin/@GAPARCH@/ncurses.so src/ncurses.c -L "${LOPTS}"

# just make it again when called with 'manual'
##  manual: doc/manual.six
##  doc/manual.six: doc/main.xml doc/browsebib.xml doc/appl.xml doc/browse.xml \
##                  doc/curses.xml doc/intro.xml doc/util.xml
manual:
	($(GAP) -l "../../;" < makedocrel.g)
	echo "LaTeX warnings:"
	grep "\(^LaTeX Warning\|^Overfull \\hbox\)" doc/main.log; exit 0

clean:
	rm -rf bin/@GAPARCH@ Makefile *~
distclean:
	rm -rf bin/* Makefile Makefile-*

doc:
	($(GAP)  < makedocrel.g)

docclean:
	(cd  doc; ./clean)

# experimental so far
WIDECHARS:
	$(GAPPATH)/gac -p "$(CFLAGS)" -d -o bin/@GAPARCH@/ncurses.so \
        src/ncurses.c -p -DWIDECHARS -L "-lpanelw  -lncursesw"

