  
  [1X7 [33X[0;0YExamples[133X[101X
  
  [33X[0;0YThis  chapter  discusses  a  number  of  [21Xnice[121X  examples of rcwa mappings and
  -groups  in  detail.  All of them show different aspects of the package, and
  the order in which they appear is entirely arbitrary. In particular they are
  not ordered by degree of difficulty or interest.[133X
  
  [33X[0;0YThe rcwa mappings, rcwa groups and other objects defined in this chapter can
  be  found  in  the  file [11Xpkg/rcwa/examples/examples.g[111X. This file can be read
  into  the current [5XGAP[105X session by the function [2XRCWALoadExamples[102X ([14X6.1-1[114X) which
  takes  no arguments and returns a record containing all examples. The global
  variable  assignments  made  in  a  section  of  this chapter can be made by
  applying  the  function  [10XAssignGlobals[110X  to  the  respective component of the
  record  returned  by  [10XRCWALoadExamples[110X. The component names are given at the
  end of the corresponding sections.[133X
  
  [33X[0;0YThe  discussions of the examples are typically far from being exhaustive. It
  is quite likely that in many instances by just a few little modifications or
  additional  easy  commands  you  can find out interesting things yourself --
  have fun![133X
  
  
  [1X7.1 [33X[0;0YThe Higman-Thompson group[133X[101X
  
  [33X[0;0YThe  Higman-Thompson  group  is  a finitely presented infinite simple group,
  cf.Â [Hig74].[133X
  
  [33X[0;0YWe show that the group[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XG := Group(List([[0,2,1,4],[0,4,1,4],[1,4,2,4],[2,4,3,4]],[127X[104X
    [4X[25X>[125X [27X                   ClassTransposition));[127X[104X
    [4X[28X<rcwa group over Z with 4 generators>[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0Yis  isomorphic  to  the  Higman-Thompson  group.  This  isomorphism has been
  pointed  out  by  John  P.  McDermott.  We  take a slightly different set of
  generators[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xk := ClassTransposition(0,2,1,2);;[127X[104X
    [4X[25Xgap>[125X [27Xl := ClassTransposition(1,2,2,4);;[127X[104X
    [4X[25Xgap>[125X [27Xm := ClassTransposition(0,2,1,4);;[127X[104X
    [4X[25Xgap>[125X [27Xn := ClassTransposition(1,4,2,4);;[127X[104X
    [4X[25Xgap>[125X [27XH := Group(k,l,m,n);[127X[104X
    [4X[28X<rcwa group over Z with 4 generators>[128X[104X
    [4X[25Xgap>[125X [27XG = H; # k, l, m and n generate G as well[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YNow  we  verify  that  our  four  generators  satisfy the relations given on
  pageÂ 50 inÂ [Hig74], when we read [10Xk[110X asÂ [22XÎº[122X, [10Xl[110X asÂ [22XÎ»[122X, [10Xm[110X asÂ [22XÎ¼[122X and [10Xn[110X asÂ [22XÎ½[122X:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XHigmanThompsonRels :=[127X[104X
    [4X[25X>[125X [27X[ k^2, l^2, m^2, n^2,                           # (1) in Higman's book[127X[104X
    [4X[25X>[125X [27X  l*k*m*k*l*n*k*n*m*k*l*k*m,                    # (2)        "[127X[104X
    [4X[25X>[125X [27X  k*n*l*k*m*n*k*l*n*m*n*l*n*m,                  # (3)        "[127X[104X
    [4X[25X>[125X [27X  (l*k*m*k*l*n)^3, (m*k*l*k*m*n)^3,             # (4)        "[127X[104X
    [4X[25X>[125X [27X  (l*n*m)^2*k*(m*n*l)^2*k,                      # (5)        "[127X[104X
    [4X[25X>[125X [27X  (l*n*m*n)^5,                                  # (6)        "[127X[104X
    [4X[25X>[125X [27X  (l*k*n*k*l*n)^3*k*n*k*(m*k*n*k*m*n)^3*k*n*k*n,# (7)        "[127X[104X
    [4X[25X>[125X [27X  ((l*k*m*n)^2*(m*k*l*n)^2)^3,                  # (8)        "[127X[104X
    [4X[25X>[125X [27X  (l*n*l*k*m*k*m*n*l*n*m*k*m*k)^4,              # (9)        "[127X[104X
    [4X[25X>[125X [27X  (m*n*m*k*l*k*l*n*m*n*l*k*l*k)^4,              #(10)        "[127X[104X
    [4X[25X>[125X [27X  (l*m*k*l*k*m*l*k*n*k)^2,                      #(11)        "[127X[104X
    [4X[25X>[125X [27X  (m*l*k*m*k*l*m*k*n*k)^2 ];                    #(12)        "[127X[104X
    [4X[28X[ IdentityMapping( Integers ), IdentityMapping( Integers ), [128X[104X
    [4X[28X  IdentityMapping( Integers ), IdentityMapping( Integers ), [128X[104X
    [4X[28X  IdentityMapping( Integers ), IdentityMapping( Integers ), [128X[104X
    [4X[28X  IdentityMapping( Integers ), IdentityMapping( Integers ), [128X[104X
    [4X[28X  IdentityMapping( Integers ), IdentityMapping( Integers ), [128X[104X
    [4X[28X  IdentityMapping( Integers ), IdentityMapping( Integers ), [128X[104X
    [4X[28X  IdentityMapping( Integers ), IdentityMapping( Integers ), [128X[104X
    [4X[28X  IdentityMapping( Integers ), IdentityMapping( Integers ) ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe  conclude  that  our group is an homomorphic image of the Higman-Thompson
  group.  But  since  the Higman-Thompson group is simple and our group is not
  trivial, this means indeed that the two groups are isomorphic.[133X
  
  [33X[0;0YIn  fact  it  is  straightforward  to  show  that  [10XG[110X is the group [22XCT_âˆ…(â„¤)[122X in
  CorollaryÂ 3.7  inÂ [Koh10],  which  is  generated  by  the  set  of all class
  transpositions  which  interchange residue classes modulo powers ofÂ 2. First
  we  check  that  [10XG[110X  contains  all  11 class transpositions which interchange
  residue classes modulo 2 orÂ 4:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XS := Filtered(List(ClassPairs(4),ClassTransposition),[127X[104X
    [4X[25X>[125X [27X                 ct->Mod(ct) in [2,4]);[127X[104X
    [4X[28X[ ClassTransposition(0,2,1,2), ClassTransposition(0,2,1,4), [128X[104X
    [4X[28X  ClassTransposition(0,2,3,4), ClassTransposition(0,4,1,4), [128X[104X
    [4X[28X  ClassTransposition(0,4,2,4), ClassTransposition(0,4,3,4), [128X[104X
    [4X[28X  ClassTransposition(1,2,0,4), ClassTransposition(1,2,2,4), [128X[104X
    [4X[28X  ClassTransposition(1,4,2,4), ClassTransposition(1,4,3,4), [128X[104X
    [4X[28X  ClassTransposition(2,4,3,4) ][128X[104X
    [4X[25Xgap>[125X [27XIsSubset(G,S);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThen  we  give a function which takes a class transposition [22XÏ„ âˆˆ CT_âˆ…(â„¤)[122X, and
  which returns a factorization of an element [22XÎ³[122X satisfying [22XÏ„^Î³ âˆˆ S[122X into [22Xg_1 :=
  (0(2),1(4))  âˆˆ  S[122X,  [22Xg_2  :=  (0(2),3(4)) âˆˆ S[122X, [22Xg_3 := (1(2),0(4)) âˆˆ S[122X, [22Xg_4 :=
  (1(2),2(4)) âˆˆ S[122X, [22Xh_1 := (0(4),1(4)) âˆˆ S[122X and [22Xh_2 := (1(4),2(4)) âˆˆ S[122X:[133X
  
  [4X[32X  GAP code  [32X[104X
    [4X[104X
    [4XReducingConjugator := function ( tau )[104X
    [4X[104X
    [4X  local  w, F, g1, g2, g3, g4, h1, h2, h, cls, cl, r;[104X
    [4X[104X
    [4X  g1 := ClassTransposition(0,2,1,4); h1 := ClassTransposition(0,4,1,4);[104X
    [4X  g2 := ClassTransposition(0,2,3,4); h2 := ClassTransposition(1,4,2,4);[104X
    [4X  g3 := ClassTransposition(1,2,0,4);[104X
    [4X  g4 := ClassTransposition(1,2,2,4);[104X
    [4X[104X
    [4X  F := FreeGroup("g1","g2","g3","g4","h1","h2");[104X
    [4X[104X
    [4X  w := One(F); if Mod(tau) <= 4 then return w; fi;[104X
    [4X[104X
    [4X  # Before we can reduce the moduli of the interchanged residue classes,[104X
    [4X  # we must make sure that both of them have at least modulus 4.[104X
    [4X  cls := TransposedClasses(tau);[104X
    [4X  if Mod(cls[1]) = 2 then[104X
    [4X    if Residue(cls[1]) = 0 then[104X
    [4X      if Residue(cls[2]) mod 4 = 1 then tau := tau^g2; w := w * F.2;[104X
    [4X                                   else tau := tau^g1; w := w * F.1; fi;[104X
    [4X    else[104X
    [4X      if Residue(cls[2]) mod 4 = 0 then tau := tau^g4; w := w * F.4;[104X
    [4X                                   else tau := tau^g3; w := w * F.3; fi;[104X
    [4X    fi;[104X
    [4X  fi;[104X
    [4X[104X
    [4X  while Mod(tau) > 4 do # Now we can successively reduce the moduli.[104X
    [4X    if not ForAny(AllResidueClassesModulo(2),[104X
    [4X                  cl -> IsEmpty(Intersection(cl,Support(tau))))[104X
    [4X    then[104X
    [4X      cls := TransposedClasses(tau);[104X
    [4X      h := Filtered([h1,h2],[104X
    [4X             hi->Length(Filtered(cls,cl->IsSubset(Support(hi),cl)))=1);[104X
    [4X      h := h[1]; tau := tau^h;[104X
    [4X      if h = h1 then w := w * F.5; else w := w * F.6; fi;[104X
    [4X    fi;[104X
    [4X    cl := TransposedClasses(tau)[2]; # class with larger modulus[104X
    [4X    r  := Residue(cl);[104X
    [4X    if   r mod 4 = 1 then tau := tau^g1; w := w * F.1;[104X
    [4X    elif r mod 4 = 3 then tau := tau^g2; w := w * F.2;[104X
    [4X    elif r mod 4 = 0 then tau := tau^g3; w := w * F.3;[104X
    [4X    elif r mod 4 = 2 then tau := tau^g4; w := w * F.4; fi;[104X
    [4X  od;[104X
    [4X[104X
    [4X  return w;[104X
    [4Xend;[104X
    [4X[104X
  [4X[32X[104X
  
  [33X[0;0YAfter  assigning  [10Xg1[110X,  [10Xg2[110X,  [10Xg3[110X,  [10Xg4[110X,  [10Xh1[110X andÂ [10Xh2[110X appropriately, we obtain for
  example:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XReducingConjugator(ClassTransposition(3,16,34,256));[127X[104X
    [4X[28Xh2*g1*h1*g1*h1*g1*h1*g1*h2*g2*h2*g4*h2*g4*h2*g3[128X[104X
    [4X[25Xgap>[125X [27Xgamma := h2*g1*h1*g1*h1*g1*h1*g1*h2*g2*h2*g4*h2*g4*h2*g3;[127X[104X
    [4X[28X<rcwa permutation of Z with modulus 256>[128X[104X
    [4X[25Xgap>[125X [27Xct := ClassTransposition(3,16,34,256)^gamma;;[127X[104X
    [4X[25Xgap>[125X [27XIsClassTransposition(ct);;[127X[104X
    [4X[25Xgap>[125X [27Xct;[127X[104X
    [4X[28XClassTransposition(1,4,2,4)[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe  Higman-Thompson  group  can  also  be  embedded  in  a natural way into
  CT(GF(2)[x]):[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xx := Indeterminate(GF(2));; SetName(x,"x");[127X[104X
    [4X[25Xgap>[125X [27XR := PolynomialRing(GF(2),1);;[127X[104X
    [4X[25Xgap>[125X [27Xk := ClassTransposition(0,x,1,x);;[127X[104X
    [4X[25Xgap>[125X [27Xl := ClassTransposition(1,x,x,x^2);;[127X[104X
    [4X[25Xgap>[125X [27Xm := ClassTransposition(0,x,1,x^2);;[127X[104X
    [4X[25Xgap>[125X [27Xn := ClassTransposition(1,x^2,x,x^2);;[127X[104X
    [4X[25Xgap>[125X [27XG := Group(k,l,m,n);[127X[104X
    [4X[28X<rcwa group over GF(2)[x] with 4 generators>[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe  correctness  of  this representation can likewise be verified by simply
  checking the defining relations given above.[133X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().HigmanThompson);[110X  in order to assign
  the global variables defined in this section.[133X
  
  
  [1X7.2 [33X[0;0YAn extension of the Collatz mapping T to a permutation of [22Xâ„¤^2[122X[101X[1X[133X[101X
  
  [33X[0;0YThe Collatz mappingÂ [22XT[122X is surjective, but not injective:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XT := RcwaMapping([[1,0,2],[3,1,2]]);;[127X[104X
    [4X[25Xgap>[125X [27XDisplay(T);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa mapping of Z with modulus 2[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | n/2      if n in 0(2)[128X[104X
    [4X[28X n |-> <  (3n+1)/2 if n in 1(2)[128X[104X
    [4X[28X        |[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XIsInjective(T); IsSurjective(T);[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XPreImages(T,2);[127X[104X
    [4X[28X[ 1, 4 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YOften,  dealing  with  rcwa  permutations  is  easier.  Indeed  the  Collatz
  mappingÂ [22XT[122X  can  be  extended  in  natural  ways  to permutations ofÂ [22Xâ„¤^2[122X. For
  example,  the  following  permutation  acts  on  the  second coordinate just
  likeÂ [22XT[122X:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XSigma_T := RcwaMapping( Integers^2, [[1,0],[0,6]],[127X[104X
    [4X[25X>[125X [27X                           [[[[2,0],[0,1]],[0,0],2],[127X[104X
    [4X[25X>[125X [27X                            [[[4,0],[0,3]],[2,1],2],[127X[104X
    [4X[25X>[125X [27X                            [[[2,0],[0,1]],[0,0],2],[127X[104X
    [4X[25X>[125X [27X                            [[[4,0],[0,3]],[2,1],2],[127X[104X
    [4X[25X>[125X [27X                            [[[4,0],[0,1]],[0,0],2],[127X[104X
    [4X[25X>[125X [27X                            [[[4,0],[0,3]],[2,1],2]] );[127X[104X
    [4X[28X<rcwa mapping of Z^2 with modulus (1,0)Z+(0,6)Z>[128X[104X
    [4X[25Xgap>[125X [27XIsBijective(Sigma_T);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XDisplay(Sigma_T);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of Z^2 with modulus (1,0)Z+(0,6)Z[128X[104X
    [4X[28X[128X[104X
    [4X[28X            /[128X[104X
    [4X[28X            | (2m+1,(3n+1)/2) if (m,n) in (0,1)+(1,0)Z+(0,2)Z[128X[104X
    [4X[28X            | (m,n/2)         if (m,n) in (0,0)+(1,0)Z+(0,6)Z U [128X[104X
    [4X[28X (m,n) |-> <                              (0,2)+(1,0)Z+(0,6)Z[128X[104X
    [4X[28X            | (2m,n/2)        if (m,n) in (0,4)+(1,0)Z+(0,6)Z[128X[104X
    [4X[28X            |[128X[104X
    [4X[28X            \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XDisplay(Sigma_T^-1);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of Z^2 with modulus (2,0)Z+(0,3)Z[128X[104X
    [4X[28X[128X[104X
    [4X[28X            /[128X[104X
    [4X[28X            | (m,2n)             if (m,n) in (0,0)+(1,0)Z+(0,3)Z U [128X[104X
    [4X[28X            |                                (0,1)+(1,0)Z+(0,3)Z[128X[104X
    [4X[28X (m,n) |-> <  (m/2,2n)           if (m,n) in (0,2)+(2,0)Z+(0,3)Z[128X[104X
    [4X[28X            | ((m-1)/2,(2n-1)/3) if (m,n) in (1,2)+(2,0)Z+(0,3)Z[128X[104X
    [4X[28X            |[128X[104X
    [4X[28X            \[128X[104X
    [4X[28X[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YNow, the [22X3n+1[122X conjecture is equivalent to the assertion that the line [22Xn=4[122X is
  a set of representatives for the cycles of [10XSigma_T[110X on the half plane [22Xn > 0[122X.[133X
  
  [33X[0;0YLet's have a look at a part of a cycle of [10XSigma_T[110X:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XTrajectory(Sigma_T,[0,27],75);[127X[104X
    [4X[28X[ [ 0, 27 ], [ 1, 41 ], [ 3, 62 ], [ 3, 31 ], [ 7, 47 ], [ 15, 71 ], [128X[104X
    [4X[28X  [ 31, 107 ], [ 63, 161 ], [ 127, 242 ], [ 127, 121 ], [ 255, 182 ], [128X[104X
    [4X[28X  [ 255, 91 ], [ 511, 137 ], [ 1023, 206 ], [ 1023, 103 ], [128X[104X
    [4X[28X  [ 2047, 155 ], [ 4095, 233 ], [ 8191, 350 ], [ 8191, 175 ], [128X[104X
    [4X[28X  [ 16383, 263 ], [ 32767, 395 ], [ 65535, 593 ], [ 131071, 890 ], [128X[104X
    [4X[28X  [ 131071, 445 ], [ 262143, 668 ], [ 262143, 334 ], [ 524286, 167 ], [128X[104X
    [4X[28X  [ 1048573, 251 ], [ 2097147, 377 ], [ 4194295, 566 ], [ 4194295, 283 ], [128X[104X
    [4X[28X  [ 8388591, 425 ], [ 16777183, 638 ], [ 16777183, 319 ], [128X[104X
    [4X[28X  [ 33554367, 479 ], [ 67108735, 719 ], [ 134217471, 1079 ], [128X[104X
    [4X[28X  [ 268434943, 1619 ], [ 536869887, 2429 ], [ 1073739775, 3644 ], [128X[104X
    [4X[28X  [ 1073739775, 1822 ], [ 2147479550, 911 ], [ 4294959101, 1367 ], [128X[104X
    [4X[28X  [ 8589918203, 2051 ], [ 17179836407, 3077 ], [ 34359672815, 4616 ], [128X[104X
    [4X[28X  [ 34359672815, 2308 ], [ 68719345630, 1154 ], [ 68719345630, 577 ], [128X[104X
    [4X[28X  [ 137438691261, 866 ], [ 137438691261, 433 ], [ 274877382523, 650 ], [128X[104X
    [4X[28X  [ 274877382523, 325 ], [ 549754765047, 488 ], [ 549754765047, 244 ], [128X[104X
    [4X[28X  [ 1099509530094, 122 ], [ 1099509530094, 61 ], [ 2199019060189, 92 ], [128X[104X
    [4X[28X  [ 2199019060189, 46 ], [ 4398038120378, 23 ], [ 8796076240757, 35 ], [128X[104X
    [4X[28X  [ 17592152481515, 53 ], [ 35184304963031, 80 ], [ 35184304963031, 40 ], [128X[104X
    [4X[28X  [ 70368609926062, 20 ], [ 70368609926062, 10 ], [ 140737219852124, 5 ], [128X[104X
    [4X[28X  [ 281474439704249, 8 ], [ 281474439704249, 4 ], [ 562948879408498, 2 ], [128X[104X
    [4X[28X  [ 562948879408498, 1 ], [ 1125897758816997, 2 ], [128X[104X
    [4X[28X  [ 1125897758816997, 1 ], [ 2251795517633995, 2 ], [128X[104X
    [4X[28X  [ 2251795517633995, 1 ] ][128X[104X
    [4X[25Xgap>[125X [27XTrajectory(Sigma_T^-1,[0,27],20);[127X[104X
    [4X[28X[ [ 0, 27 ], [ 0, 54 ], [ 0, 108 ], [ 0, 216 ], [ 0, 432 ], [ 0, 864 ], [128X[104X
    [4X[28X  [ 0, 1728 ], [ 0, 3456 ], [ 0, 6912 ], [ 0, 13824 ], [ 0, 27648 ], [128X[104X
    [4X[28X  [ 0, 55296 ], [ 0, 110592 ], [ 0, 221184 ], [ 0, 442368 ], [128X[104X
    [4X[28X  [ 0, 884736 ], [ 0, 1769472 ], [ 0, 3538944 ], [ 0, 7077888 ], [128X[104X
    [4X[28X  [ 0, 14155776 ] ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWhile it seems easy to make conjectures regarding the behaviour of cycles of
  [10XSigma_T[110X, obtaining results on it is apparently hard. We observe however that
  [10XSigma_T[110X  can be written as a product of two permutations ofÂ [22Xâ„¤^2[122X whose cycles
  can be described easily:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xa := RcwaMapping(Integers^2,[[1,0],[0,2]],[[[[4,0],[0,1]],[0, 0],2],[127X[104X
    [4X[25X>[125X [27X                                              [[[4,0],[0,1]],[2,-1],2]]);[127X[104X
    [4X[28X<rcwa mapping of Z^2 with modulus (1,0)Z+(0,2)Z>[128X[104X
    [4X[25Xgap>[125X [27Xb := a^-1*Sigma_T;[127X[104X
    [4X[28X<rcwa permutation of Z^2 with modulus (2,0)Z+(0,3)Z>[128X[104X
    [4X[25Xgap>[125X [27XDisplay(a);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of Z^2 with modulus (1,0)Z+(0,2)Z[128X[104X
    [4X[28X[128X[104X
    [4X[28X            /[128X[104X
    [4X[28X            | (2m,n/2)       if (m,n) in (0,0)+(1,0)Z+(0,2)Z[128X[104X
    [4X[28X (m,n) |-> <  (2m+1,(n-1)/2) if (m,n) in (0,1)+(1,0)Z+(0,2)Z[128X[104X
    [4X[28X            |[128X[104X
    [4X[28X            \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XDisplay(b);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of Z^2 with modulus (2,0)Z+(0,3)Z[128X[104X
    [4X[28X[128X[104X
    [4X[28X            /[128X[104X
    [4X[28X            | (m,3n+2) if (m,n) in (1,0)+(2,0)Z+(0,1)Z[128X[104X
    [4X[28X            | (m/2,n)  if (m,n) in (0,0)+(2,0)Z+(0,3)Z U [128X[104X
    [4X[28X (m,n) |-> <                       (0,1)+(2,0)Z+(0,3)Z[128X[104X
    [4X[28X            | (m,n)    if (m,n) in (0,2)+(2,0)Z+(0,3)Z[128X[104X
    [4X[28X            |[128X[104X
    [4X[28X            \[128X[104X
    [4X[28X[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YIt  is  easy  to  see that both [10Xa[110X andÂ [10Xb[110X have infinite order. The cycles ofÂ [10Xa[110X
  have roughly hyperbolic shape and run, so to speak, from [22X(0,Â± âˆž)[122X to [22X(Â± âˆž,0)[122X.
  A  given  cycle contains only finitely many points both of whose coordinates
  are  nonzero. The fixed points ofÂ [10Xa[110X are (0,0) and (-1,-1). We have a look at
  an example of a cycle ofÂ [10Xa[110X:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XTrajectory(a,[1000,1000],15);[127X[104X
    [4X[28X[ [ 1000, 1000 ], [ 2000, 500 ], [ 4000, 250 ], [ 8000, 125 ], [128X[104X
    [4X[28X  [ 16001, 62 ], [ 32002, 31 ], [ 64005, 15 ], [ 128011, 7 ], [128X[104X
    [4X[28X  [ 256023, 3 ], [ 512047, 1 ], [ 1024095, 0 ], [ 2048190, 0 ], [128X[104X
    [4X[28X  [ 4096380, 0 ], [ 8192760, 0 ], [ 16385520, 0 ] ][128X[104X
    [4X[25Xgap>[125X [27XTrajectory(a^-1,[1000,1000],15);[127X[104X
    [4X[28X[ [ 1000, 1000 ], [ 500, 2000 ], [ 250, 4000 ], [ 125, 8000 ], [128X[104X
    [4X[28X  [ 62, 16001 ], [ 31, 32002 ], [ 15, 64005 ], [ 7, 128011 ], [128X[104X
    [4X[28X  [ 3, 256023 ], [ 1, 512047 ], [ 0, 1024095 ], [ 0, 2048190 ], [128X[104X
    [4X[28X  [ 0, 4096380 ], [ 0, 8192760 ], [ 0, 16385520 ] ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YIt is left as an easy exercise to the reader to find out how the cycles ofÂ [10Xb[110X
  look like.[133X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().ZxZ);[110X  in order to assign the global
  variables defined in this section.[133X
  
  
  [1X7.3 [33X[0;0YFactoring Collatz' permutation of the integers[133X[101X
  
  [33X[0;0YIn  1932, Lothar Collatz mentioned in his notebook the following permutation
  of the integers:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XCollatz := RcwaMapping([[2,0,3],[4,-1,3],[4,1,3]]);;[127X[104X
    [4X[25Xgap>[125X [27XDisplay(Collatz);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa mapping of Z with modulus 3[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | 2n/3     if n in 0(3)[128X[104X
    [4X[28X n |-> <  (4n-1)/3 if n in 1(3)[128X[104X
    [4X[28X        | (4n+1)/3 if n in 2(3)[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XShortCycles(Collatz,[-50..50],50); # There are some finite cycles:[127X[104X
    [4X[28X[ [ -111, -74, -99, -66, -44, -59, -79, -105, -70, -93, -62, -83 ], [128X[104X
    [4X[28X  [ -9, -6, -4, -5, -7 ], [ -3, -2 ], [ -1 ], [ 0 ], [ 1 ], [ 2, 3 ], [128X[104X
    [4X[28X  [ 4, 5, 7, 9, 6 ], [ 44, 59, 79, 105, 70, 93, 62, 83, 111, 74, 99, 66 ] ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe  cycle  structure  of  Collatz'  permutation  has  not  been  completely
  determined yet. In particular it is not known whether the cycle containingÂ 8
  is  finite  or infinite. Nevertheless, the factorization routine included in
  this  package  can  determine a factorization of this permutation into class
  transpositions, i.e. involutions interchanging two disjoint residue classes:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XCollatz in CT(Integers);  # `Collatz' lies in the simple group CT(Z).[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XLength(Factorization(Collatz));[127X[104X
    [4X[28X212[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YSetting  the  Info  level of [10XInfoRCWA[110X equal toÂ 2 (simply issue [10XRCWAInfo(2);[110X)
  causes  the  factorization  routine  to  display detailed information on the
  progress  of the factoring process. For reasons of saving space, this is not
  done in this manual.[133X
  
  [33X[0;0YWe  would like to get a factorization into fewer factors. Firstly, we try to
  factor  the  inverse  --  just  like  the various options interpreted by the
  factorization  routine,  this  has  influence  on decisions taken during the
  factoring process:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XLength(Factorization(Collatz^-1));[127X[104X
    [4X[28X129[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThis  is  already  a shorter product, but can still be improved. We remember
  the  [10XmKnot[110X's,  of  which  the  permutation  [10XmKnot(3)[110X  looks  very similar to
  Collatz'  permutation. Therefore it is straightforward to try to factor both
  [10XmKnot(3)[110X and [10XCollatz/mKnot(3)[110X, and to look whether the sum of the numbers of
  factors is less thanÂ 129:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XKnotFacts := Factorization(mKnot(3));;[127X[104X
    [4X[25Xgap>[125X [27XQuotFacts := Factorization(Collatz/mKnot(3));;[127X[104X
    [4X[25Xgap>[125X [27XList([KnotFacts,QuotFacts],Length);[127X[104X
    [4X[28X[ 59, 9 ][128X[104X
    [4X[25Xgap>[125X [27XCollatzFacts := Concatenation(QuotFacts,KnotFacts);[127X[104X
    [4X[28X[ ClassTransposition(0,6,4,6), ClassTransposition(0,6,5,6), [128X[104X
    [4X[28X  ClassTransposition(0,6,3,6), ClassTransposition(0,6,1,6), [128X[104X
    [4X[28X  ClassTransposition(0,6,2,6), ClassTransposition(2,3,4,6), [128X[104X
    [4X[28X  ClassTransposition(0,3,4,6), ClassTransposition(2,3,1,6), [128X[104X
    [4X[28X  ClassTransposition(0,3,1,6), ClassTransposition(0,36,35,36), [128X[104X
    [4X[28X  ClassTransposition(0,36,22,36), ClassTransposition(0,36,18,36), [128X[104X
    [4X[28X  ClassTransposition(0,36,17,36), ClassTransposition(0,36,14,36), [128X[104X
    [4X[28X  ClassTransposition(0,36,20,36), ClassTransposition(0,36,4,36), [128X[104X
    [4X[28X  ClassTransposition(2,36,8,36), ClassTransposition(2,36,16,36), [128X[104X
    [4X[28X  ClassTransposition(2,36,13,36), ClassTransposition(2,36,9,36), [128X[104X
    [4X[28X  ClassTransposition(2,36,7,36), ClassTransposition(2,36,6,36), [128X[104X
    [4X[28X  ClassTransposition(2,36,3,36), ClassTransposition(2,36,10,36), [128X[104X
    [4X[28X  ClassTransposition(2,36,15,36), ClassTransposition(2,36,12,36), [128X[104X
    [4X[28X  ClassTransposition(2,36,5,36), ClassTransposition(21,36,28,36), [128X[104X
    [4X[28X  ClassTransposition(21,36,33,36), ClassTransposition(21,36,30,36), [128X[104X
    [4X[28X  ClassTransposition(21,36,23,36), ClassTransposition(21,36,34,36), [128X[104X
    [4X[28X  ClassTransposition(21,36,31,36), ClassTransposition(21,36,27,36), [128X[104X
    [4X[28X  ClassTransposition(21,36,25,36), ClassTransposition(21,36,24,36), [128X[104X
    [4X[28X  ClassTransposition(26,36,32,36), ClassTransposition(26,36,29,36), [128X[104X
    [4X[28X  ClassTransposition(10,18,35,36), ClassTransposition(5,18,35,36), [128X[104X
    [4X[28X  ClassTransposition(10,18,17,36), ClassTransposition(5,18,17,36), [128X[104X
    [4X[28X  ClassTransposition(8,12,14,24), ClassTransposition(6,9,17,18), [128X[104X
    [4X[28X  ClassTransposition(3,9,17,18), ClassTransposition(0,9,17,18), [128X[104X
    [4X[28X  ClassTransposition(6,9,16,18), ClassTransposition(3,9,16,18), [128X[104X
    [4X[28X  ClassTransposition(0,9,16,18), ClassTransposition(6,9,11,18), [128X[104X
    [4X[28X  ClassTransposition(3,9,11,18), ClassTransposition(0,9,11,18), [128X[104X
    [4X[28X  ClassTransposition(6,9,4,18), ClassTransposition(3,9,4,18), [128X[104X
    [4X[28X  ClassTransposition(0,9,4,18), ClassTransposition(0,6,14,24), [128X[104X
    [4X[28X  ClassTransposition(0,6,2,24), ClassTransposition(8,12,17,18), [128X[104X
    [4X[28X  ClassTransposition(7,12,17,18), ClassTransposition(8,12,11,18), [128X[104X
    [4X[28X  ClassTransposition(7,12,11,18), PrimeSwitch(3)^-1, [128X[104X
    [4X[28X  ClassTransposition(7,12,17,18), ClassTransposition(2,6,17,18), [128X[104X
    [4X[28X  ClassTransposition(0,3,17,18), PrimeSwitch(3)^-1, PrimeSwitch(3)^-1, [128X[104X
    [4X[28X  PrimeSwitch(3)^-1 ][128X[104X
    [4X[25Xgap>[125X [27XProduct(CollatzFacts) = Collatz; # Check.[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe   factors   [10XPrimeSwitch(3)[110X   are  products  of  6  class  transpositions
  (cf.Â [2XPrimeSwitch[102X ([14X2.5-2[114X)).[133X
  
  [33X[0;0YEnter [10XAssignGlobals(RCWALoadExamples().CollatzlikePerms);[110X in order to assign
  the global variables defined in this section.[133X
  
  
  [1X7.4 [33X[0;0YAn rcwa mapping which seems to be contracting, but very slow[133X[101X
  
  [33X[0;0YThe  iterates of an integer under the Collatz mapping [22XT[122X seem to approach its
  contraction  centre  -- this is the finite set where all trajectories end up
  after  a  finite number of steps -- rather quickly and do not get very large
  before  doing so (of course this is a purely heuristic statement as the [22X3n+1[122X
  Conjecture has not been proved so far!):[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XT := RcwaMapping([[1,0,2],[3,1,2]]);;[127X[104X
    [4X[25Xgap>[125X [27XS0 := LikelyContractionCentre(T,100,1000);[127X[104X
    [4X[28X#I  Warning: `LikelyContractionCentre' is highly probabilistic.[128X[104X
    [4X[28XThe returned result can only be regarded as a rough guess.[128X[104X
    [4X[28XSee ?LikelyContractionCentre for more information.[128X[104X
    [4X[28X[ -136, -91, -82, -68, -61, -55, -41, -37, -34, -25, -17, -10, -7, -5, [128X[104X
    [4X[28X  -1, 0, 1, 2 ][128X[104X
    [4X[25Xgap>[125X [27XS0^T = S0; # This holds by definition of the contraction centre.[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XList([1..30],n->Length(Trajectory(T,n,S0)));[127X[104X
    [4X[28X[ 1, 1, 5, 2, 4, 6, 11, 3, 13, 5, 10, 7, 7, 12, 12, 4, 9, 14, 14, 6, 6, [128X[104X
    [4X[28X  11, 11, 8, 16, 8, 70, 13, 13, 13 ][128X[104X
    [4X[25Xgap>[125X [27XMaximum(List([1..1000],n->Length(Trajectory(T,n,S0))));[127X[104X
    [4X[28X113[128X[104X
    [4X[25Xgap>[125X [27XMaximum(List([1..1000],n->Maximum(Trajectory(T,n,S0))));[127X[104X
    [4X[28X125252[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe  following mapping seems to be contracting as well, but its trajectories
  are much longer:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xf6 := RcwaMapping([[ 1,0,6],[ 5, 1,6],[ 7,-2,6],[127X[104X
    [4X[25X>[125X [27X                      [11,3,6],[11,-2,6],[11,-1,6]]);;[127X[104X
    [4X[25Xgap>[125X [27XDisplay(f6);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa mapping of Z with modulus 6[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | n/6       if n in 0(6)[128X[104X
    [4X[28X        | (5n+1)/6  if n in 1(6)[128X[104X
    [4X[28X        | (7n-2)/6  if n in 2(6)[128X[104X
    [4X[28X n |-> <  (11n+3)/6 if n in 3(6)[128X[104X
    [4X[28X        | (11n-2)/6 if n in 4(6)[128X[104X
    [4X[28X        | (11n-1)/6 if n in 5(6)[128X[104X
    [4X[28X        |[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XS0 := LikelyContractionCentre(f6,1000,100000);;[127X[104X
    [4X[28X#I  Warning: `LikelyContractionCentre' is highly probabilistic.[128X[104X
    [4X[28XThe returned result can only be regarded as a rough guess.[128X[104X
    [4X[28XSee ?LikelyContractionCentre for more information.[128X[104X
    [4X[25Xgap>[125X [27XTrajectory(f6,25,S0);[127X[104X
    [4X[28X[ 25, 21, 39, 72, 12, 2 ][128X[104X
    [4X[25Xgap>[125X [27XList([1..100],n->Length(Trajectory(f6,n,S0)));[127X[104X
    [4X[28X[ 1, 1, 3, 4, 1, 2, 3, 2, 1, 5, 7, 2, 8, 17, 3, 16, 1, 4, 17, 6, 5, 2, [128X[104X
    [4X[28X  5, 5, 6, 1, 4, 2, 15, 1, 1, 3, 2, 5, 13, 3, 2, 3, 4, 1, 8, 4, 4, 2, 7, [128X[104X
    [4X[28X  19, 23517, 3, 9, 3, 1, 18, 14, 2, 20, 23512, 14, 2, 6, 6, 1, 4, 19, [128X[104X
    [4X[28X  12, 23511, 8, 23513, 10, 1, 13, 13, 3, 1, 23517, 7, 20, 7, 9, 9, 6, [128X[104X
    [4X[28X  12, 8, 6, 18, 14, 23516, 31, 12, 23545, 4, 21, 19, 5, 1, 17, 17, 13, [128X[104X
    [4X[28X  19, 6, 23515 ][128X[104X
    [4X[25Xgap>[125X [27XMaximum(Trajectory(f6,47,S0));[127X[104X
    [4X[28X7363391777762473304431877054771075818733690108051469808715809256737742295\[128X[104X
    [4X[28X45698886054[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YComputing  the  trajectory  of  3224  takes quite a while -- this trajectory
  ascends  to  about [22X3 â‹… 10^2197[122X, before it approaches the fixed pointÂ 2 after
  19949562 steps.[133X
  
  [33X[0;0YWhen  constructing  the mapping [10Xf6[110X, the denominators of the partial mappings
  have  been  chosen  to  be  equal  and the numerators have been chosen to be
  numbers  coprime  to  the common denominator, whose product is just a little
  bit  smaller than the [10XModulus(f6)[110Xth power of the denominator. In the example
  we have [22X5 â‹… 7 â‹… 11^3 = 46585[122X and [22X6^6 = 46656[122X.[133X
  
  [33X[0;0YAlthough  the  trajectories of [10XT[110X are much shorter than those of [10Xf6[110X, it seems
  likely that this does not make the problem of deciding whether the mappingÂ [10XT[110X
  is  contracting  essentially  easier  -- even for mappings with much shorter
  trajectories  thanÂ [10XT[110X  the  problem  seems to be equally hard. A solution can
  usually  only be found in trivial cases, i.e. for example when there is some
  [22Xk[122X  such that applying the [22Xk[122Xth power of the respective mapping to any integer
  decreases its absolute value.[133X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().SlowlyContractingMappings);[110X in order
  to assign the global variables defined in this section.[133X
  
  
  [1X7.5 [33X[0;0YChecking a result by P. Andaloro[133X[101X
  
  [33X[0;0YIn [And00], P.Â Andaloro has shown that proving that trajectories of integers
  [22Xn  âˆˆ 1(16)[122X under the Collatz mapping always containÂ 1 would be sufficient to
  prove  the  [22X3n+1[122X Conjecture. In the sequel, this result is verified by [5XRCWA[105X.
  Checking  that  the  union  of  the  images of the residue class 1(16) under
  powers  of the Collatz mappingÂ [22XT[122X contains [22Xâ„¤ âˆ– 0(3)[122X is obviously enough. Thus
  we put [22XS := 1(16)[122X, and successively unite the setÂ [22XS[122X with its image underÂ [22XT[122X:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XT := RcwaMapping([[1,0,2],[3,1,2]]);[127X[104X
    [4X[28X<rcwa mapping of Z with modulus 2>[128X[104X
    [4X[25Xgap>[125X [27XS := ResidueClass(Integers,16,1);[127X[104X
    [4X[28X1(16)[128X[104X
    [4X[25Xgap>[125X [27XS := Union(S,S^T);[127X[104X
    [4X[28X1(16) U 2(24)[128X[104X
    [4X[25Xgap>[125X [27XS := Union(S,S^T);[127X[104X
    [4X[28X1(12) U 2(24) U 17(48) U 33(48)[128X[104X
    [4X[25Xgap>[125X [27XS := Union(S,S^T);[127X[104X
    [4X[28X<union of 30 residue classes (mod 144)>[128X[104X
    [4X[25Xgap>[125X [27XS := Union(S,S^T);[127X[104X
    [4X[28X<union of 42 residue classes (mod 144)>[128X[104X
    [4X[25Xgap>[125X [27XS := Union(S,S^T);[127X[104X
    [4X[28X<union of 172 residue classes (mod 432)>[128X[104X
    [4X[25Xgap>[125X [27XS := Union(S,S^T);[127X[104X
    [4X[28X<union of 676 residue classes (mod 1296)>[128X[104X
    [4X[25Xgap>[125X [27XS := Union(S,S^T);[127X[104X
    [4X[28X<union of 810 residue classes (mod 1296)>[128X[104X
    [4X[25Xgap>[125X [27XS := Union(S,S^T);[127X[104X
    [4X[28X<union of 2638 residue classes (mod 3888)>[128X[104X
    [4X[25Xgap>[125X [27XS := Union(S,S^T);[127X[104X
    [4X[28X<union of 33 residue classes (mod 48)>[128X[104X
    [4X[25Xgap>[125X [27XS := Union(S,S^T);[127X[104X
    [4X[28X<union of 33 residue classes (mod 48)>[128X[104X
    [4X[25Xgap>[125X [27XUnion(S,ResidueClass(Integers,3,0)); # Et voila ...[127X[104X
    [4X[28XIntegers[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YFurther similar computations are shown in SectionÂ [14X7.14[114X.[133X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().CollatzMapping);[110X  in order to assign
  the global variables defined in this section.[133X
  
  
  [1X7.6 [33X[0;0YTwo examples by Matthews and Leigh[133X[101X
  
  [33X[0;0YIn  [ML87],  K.Â R.Â Matthews and G.Â M.Â Leigh have shown that two trajectories
  of  the  following  (surjective,  but  not  injective)  mappings are acyclic
  (modÂ [22Xx[122X) and divergent:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xx := Indeterminate(GF(4),1);; SetName(x,"x");[127X[104X
    [4X[25Xgap>[125X [27XR := PolynomialRing(GF(2),1);[127X[104X
    [4X[28XGF(2)[x][128X[104X
    [4X[25Xgap>[125X [27XML1 := RcwaMapping(R,x,[[1,0,x],[(x+1)^3,1,x]]*One(R));;[127X[104X
    [4X[25Xgap>[125X [27XML2 := RcwaMapping(R,x,[[1,0,x],[(x+1)^2,1,x]]*One(R));;[127X[104X
    [4X[25Xgap>[125X [27XDisplay(ML1);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa mapping of GF(2)[x] with modulus x[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | P/x                     if P in 0(x)[128X[104X
    [4X[28X P |-> <  ((x^3+x^2+x+1)*P + 1)/x if P in 1(x)[128X[104X
    [4X[28X        |[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XDisplay(ML2);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa mapping of GF(2)[x] with modulus x[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | P/x               if P in 0(x)[128X[104X
    [4X[28X P |-> <  ((x^2+1)*P + 1)/x if P in 1(x)[128X[104X
    [4X[28X        |[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XList([ML1,ML2],IsSurjective);[127X[104X
    [4X[28X[ true, true ][128X[104X
    [4X[25Xgap>[125X [27XList([ML1,ML2],IsInjective);[127X[104X
    [4X[28X[ false, false ][128X[104X
    [4X[25Xgap>[125X [27Xtraj1 := Trajectory(ML1,One(R),16);[127X[104X
    [4X[28X[ 1, x^2+x+1, x^4+x^2+x, x^3+x+1, x^5+x^4+x^2, x^4+x^3+x, x^3+x^2+1, [128X[104X
    [4X[28X  x^5+x^2+1, x^7+x^6+x^5+x^3+1, x^9+x^7+x^6+x^5+x^3+x+1, [128X[104X
    [4X[28X  x^11+x^10+x^8+x^7+x^6+x^5+x^2, x^10+x^9+x^7+x^6+x^5+x^4+x, [128X[104X
    [4X[28X  x^9+x^8+x^6+x^5+x^4+x^3+1, x^11+x^8+x^7+x^6+x^4+x+1, [128X[104X
    [4X[28X  x^13+x^12+x^11+x^8+x^7+x^6+x^4, x^12+x^11+x^10+x^7+x^6+x^5+x^3 ][128X[104X
    [4X[25Xgap>[125X [27Xtraj2 := Trajectory(ML2,(x^3+x+1)*One(R),16);[127X[104X
    [4X[28X[ x^3+x+1, x^4+x+1, x^5+x^3+x^2+x+1, x^6+x^3+1, x^7+x^5+x^4+x^2+x, [128X[104X
    [4X[28X  x^6+x^4+x^3+x+1, x^7+x^4+x^3+x+1, x^8+x^6+x^5+x^4+x^3+x+1, [128X[104X
    [4X[28X  x^9+x^6+x^3+x+1, x^10+x^8+x^7+x^5+x^4+x+1, [128X[104X
    [4X[28X  x^11+x^8+x^7+x^5+x^4+x^3+x^2+x+1, x^12+x^10+x^9+x^8+x^7+x^5+1, [128X[104X
    [4X[28X  x^13+x^10+x^7+x^4+x, x^12+x^9+x^6+x^3+1, [128X[104X
    [4X[28X  x^13+x^11+x^10+x^8+x^7+x^5+x^4+x^2+x, [128X[104X
    [4X[28X  x^12+x^10+x^9+x^7+x^6+x^4+x^3+x+1 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe  pattern  which  Matthews  and  Leigh used to show the divergence of the
  above  trajectories can be recognized easily by looking at the corresponding
  Markov chains with the two states 0Â modÂ [22Xx[122X and 1Â modÂ [22Xx[122X:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xtraj1modx := Trajectory(ML1,One(R),400,x);;[127X[104X
    [4X[25Xgap>[125X [27Xtraj2modx := Trajectory(ML2,(x^3+x+1)*One(R),600,x);;[127X[104X
    [4X[25Xgap>[125X [27XList(traj1modx{[1..150]},val->Position([Zero(R),One(R)],val)-1);[127X[104X
    [4X[28X[ 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ][128X[104X
    [4X[25Xgap>[125X [27XList(traj2modx{[1..150]},val->Position([Zero(R),One(R)],val)-1);[127X[104X
    [4X[28X[ 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, [128X[104X
    [4X[28X  1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, [128X[104X
    [4X[28X  0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWhat  is important here are the lengths of the intervals between two changes
  from one state to the other:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XChangePoints := l->Filtered([1..Length(l)-1],pos->l[pos]<>l[pos+1]);;[127X[104X
    [4X[25Xgap>[125X [27XDiffs := l->List([1..Length(l)-1],pos->l[pos+1]-l[pos]);;[127X[104X
    [4X[25Xgap>[125X [27XDiffs(ChangePoints(traj1modx)); # The pattern in the first ...[127X[104X
    [4X[28X[ 1, 1, 2, 4, 2, 2, 4, 8, 4, 4, 8, 16, 8, 8, 16, 32, 16, 16, 32, 64, 32, [128X[104X
    [4X[28X  32, 64 ][128X[104X
    [4X[25Xgap>[125X [27XDiffs(ChangePoints(traj2modx)); # ... and in the second example.[127X[104X
    [4X[28X[ 1, 7, 1, 1, 1, 13, 1, 1, 1, 1, 1, 1, 1, 25, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 49, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 97, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 193, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, [128X[104X
    [4X[28X  1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ][128X[104X
    [4X[25Xgap>[125X [27XDiffs(ChangePoints(last)); # Make this a bit more obvious.[127X[104X
    [4X[28X[ 1, 3, 1, 7, 1, 15, 1, 31, 1, 63, 1 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThis  looks  clearly acyclic, thus the trajectories diverge. Needless to say
  however  that  this  computational evidence does not replace the proof along
  these  lines given in the article cited above, but just sheds a light on the
  idea behind it.[133X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().MatthewsLeigh);[110X  in  order to assign
  the global variables defined in this section.[133X
  
  
  [1X7.7 [33X[0;0YOrders of commutators[133X[101X
  
  [33X[0;0YWe enter some wild rcwa permutation:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xu := RcwaMapping([[3,0,5],[9,1,5],[3,-1,5],[9,-2,5],[9,4,5]]);;[127X[104X
    [4X[25Xgap>[125X [27XIsTame(u);;[127X[104X
    [4X[25Xgap>[125X [27XDisplay(u);[127X[104X
    [4X[28X[128X[104X
    [4X[28XWild rcwa permutation of Z with modulus 5[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | 3n/5     if n in 0(5)[128X[104X
    [4X[28X        | (9n+1)/5 if n in 1(5)[128X[104X
    [4X[28X n |-> <  (3n-1)/5 if n in 2(5)[128X[104X
    [4X[28X        | (9n-2)/5 if n in 3(5)[128X[104X
    [4X[28X        | (9n+4)/5 if n in 4(5)[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe  would like to compute the order of [22X[u,n â†¦ n + k][122X and [22X[u^2,n â†¦ n + k][122X for
  different values ofÂ [22Xk[122X:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xnu := ClassShift(0,1);; # n -> n + 1[127X[104X
    [4X[25Xgap>[125X [27Xl := Filtered([0..100],k->IsTame(Comm(u,nu^k)));[127X[104X
    [4X[28X[ 0, 2, 3, 5, 6, 9, 10, 12, 13, 15, 17, 18, 20, 21, 24, 25, 27, 28, 30, [128X[104X
    [4X[28X  32, 33, 35, 36, 39, 40, 42, 43, 45, 47, 48, 50, 51, 54, 55, 57, 58, [128X[104X
    [4X[28X  60, 62, 63, 65, 66, 69, 70, 72, 73, 75, 77, 78, 80, 81, 84, 85, 87, [128X[104X
    [4X[28X  88, 90, 92, 93, 95, 96, 99, 100 ][128X[104X
    [4X[25Xgap>[125X [27XList(l,k->Order(Comm(u,nu^k)));[127X[104X
    [4X[28X[ 1, 6, 5, 3, 5, 5, 3, infinity, 7, infinity, 7, 5, 3, infinity, [128X[104X
    [4X[28X  infinity, 3, 5, 7, infinity, 7, infinity, 3, 5, 5, 3, 5, infinity, [128X[104X
    [4X[28X  infinity, infinity, 5, 3, 5, 5, 3, infinity, 7, infinity, 7, 5, 3, [128X[104X
    [4X[28X  infinity, infinity, 3, 5, 7, infinity, 7, infinity, 3, 5, 5, 3, 5, [128X[104X
    [4X[28X  infinity, infinity, infinity, 5, 3, 5, 5, 3 ][128X[104X
    [4X[25Xgap>[125X [27Xu2 := u^2;[127X[104X
    [4X[28X<wild rcwa permutation of Z with modulus 25>[128X[104X
    [4X[25Xgap>[125X [27XFiltered([1..16],k->IsTame(Comm(u2,nu^k))); # k < 15 -> commutator wild![127X[104X
    [4X[28X[ 15 ][128X[104X
    [4X[25Xgap>[125X [27XOrder(Comm(u2,nu^15));[127X[104X
    [4X[28Xinfinity[128X[104X
    [4X[25Xgap>[125X [27Xu2nu17 := Comm(u2,nu^17);[127X[104X
    [4X[28X<rcwa permutation of Z with modulus 81>[128X[104X
    [4X[25Xgap>[125X [27Xcycs := ShortCycles(u2nu17,[-100..100],100);;[127X[104X
    [4X[25Xgap>[125X [27XList(cycs,Length);[127X[104X
    [4X[28X[ 72, 72, 73, 72, 73, 72, 72, 73, 72, 72, 72, 73, 72, 72, 73, 72, 72, [128X[104X
    [4X[28X  73, 72, 72, 73, 72, 72 ][128X[104X
    [4X[25Xgap>[125X [27XLcm(last);[127X[104X
    [4X[28X5256[128X[104X
    [4X[25Xgap>[125X [27Xu2nu17^5256; # This element has indeed order 2^3*3^2*73 = 5256.[127X[104X
    [4X[28XIdentityMapping( Integers )[128X[104X
    [4X[25Xgap>[125X [27Xu2nu18 := Comm(u2,nu^18);[127X[104X
    [4X[28X<rcwa permutation of Z with modulus 81>[128X[104X
    [4X[25Xgap>[125X [27Xcycs := ShortCycles(u2nu18,[-100..100],100);;[127X[104X
    [4X[25Xgap>[125X [27XList(cycs,Length);[127X[104X
    [4X[28X[ 22, 22, 22, 21, 22, 22, 22, 21, 21, 22, 22, 21, 22, 21, 22, 22, 21, [128X[104X
    [4X[28X  22, 22, 21, 22, 22, 21 ][128X[104X
    [4X[25Xgap>[125X [27XLcm(last);[127X[104X
    [4X[28X462[128X[104X
    [4X[25Xgap>[125X [27Xu2nu18^462; # This is an element of order 2*3*7*11 = 462.[127X[104X
    [4X[28XIdentityMapping( Integers )[128X[104X
    [4X[25Xgap>[125X [27XList([Comm(u2,nu^20),Comm(u2,nu^25),Comm(u2,nu^30)],Order);[127X[104X
    [4X[28X[ 29, 9, 15 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe  observe that our commutators have various different orders, and that the
  prime factors of these orders are not all [21Xvery small[121X.[133X
  
  [33X[0;0YEnter [10XAssignGlobals(RCWALoadExamples().CollatzlikePerms);[110X in order to assign
  the global variables defined in this section.[133X
  
  
  [1X7.8 [33X[0;0YAn infinite subgroup of CT(GF(2)[x]) with many torsion elements[133X[101X
  
  [33X[0;0YIn this section, we have a look at the following subgroup of CT(GF(2)[x]):[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xx := Indeterminate(GF(2));; SetName(x,"x");[127X[104X
    [4X[25Xgap>[125X [27XR := PolynomialRing(GF(2),1);[127X[104X
    [4X[28XGF(2)[x][128X[104X
    [4X[25Xgap>[125X [27Xa := ClassTransposition(0,x,1,x);;[127X[104X
    [4X[25Xgap>[125X [27Xb := ClassTransposition(0,x^2+1,1,x^2+1);;[127X[104X
    [4X[25Xgap>[125X [27Xc := ClassTransposition(1,x,0,x^2+x);;[127X[104X
    [4X[25Xgap>[125X [27XG := Group(a,b,c);[127X[104X
    [4X[28X<rcwa group over GF(2)[x] with 3 generators>[128X[104X
    [4X[25Xgap>[125X [27XDisplay(G);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa group over GF(2)[x], generated by[128X[104X
    [4X[28X[128X[104X
    [4X[28X[[128X[104X
    [4X[28XRcwa permutation of GF(2)[x]: P -> P + Z(2)^0[128X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of GF(2)[x] with modulus x^2+1, of order 2[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | P + 1 if P in 0(x^2+1) U 1(x^2+1)[128X[104X
    [4X[28X P |-> <  P     if P in x(x^2+1) U x+1(x^2+1)[128X[104X
    [4X[28X        |[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of GF(2)[x] with modulus x^2+x, of order 2[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | (x+1)*P + x+1   if P in 1(x)[128X[104X
    [4X[28X P |-> <  (P + x+1)/(x+1) if P in 0(x^2+x)[128X[104X
    [4X[28X        | P               if P in x(x^2+x)[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[28X][128X[104X
    [4X[28X[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe can easily find 2 normal subgroups ofÂ [10XG[110X:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XN1 := Subgroup(G,[a*b,a*c]);[127X[104X
    [4X[28X<rcwa group over GF(2)[x] with 2 generators>[128X[104X
    [4X[25Xgap>[125X [27XIsNormal(G,N1);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIndex(G,N1);[127X[104X
    [4X[28X2[128X[104X
    [4X[25Xgap>[125X [27XG/N1;[127X[104X
    [4X[28XGroup([ (1,2), (1,2), (1,2) ])[128X[104X
    [4X[25Xgap>[125X [27XN2 := Subgroup(G,[a*b*c,a*c]);;[127X[104X
    [4X[25Xgap>[125X [27XIsNormal(G,N2);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsSubgroup(N1,N2);[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YProducts  of  even  numbers  of generators ofÂ [10XG[110X may have infinite order. For
  example, we have[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XOrder(a*b);[127X[104X
    [4X[28X2[128X[104X
    [4X[25Xgap>[125X [27XOrder(a*c);[127X[104X
    [4X[28Xinfinity[128X[104X
    [4X[25Xgap>[125X [27XOrder(b*c);[127X[104X
    [4X[28Xinfinity[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe  would  like  to  have  a  look  at  orders of products of odd numbers of
  generators. In order to restrict our considerations to [21Xessentially different[121X
  products  (as  far as we can easily do this), we use the following auxiliary
  function:[133X
  
  [4X[32X  GAP code  [32X[104X
    [4X[104X
    [4XNormedWords := function ( F, lng )[104X
    [4X[104X
    [4X  local  words, gens, tuples, w;[104X
    [4X[104X
    [4X  gens   := GeneratorsOfGroup(F);[104X
    [4X  tuples := EnumeratorOfTuples([1..3],lng);[104X
    [4X  words  := [];[104X
    [4X[104X
    [4X  for w in tuples do[104X
    [4X    if    (w[1] = 1 or not 1 in w)[104X
    [4X      and PositionSublist(w,[1,1]) = fail[104X
    [4X      and PositionSublist(w,[2,2]) = fail[104X
    [4X      and PositionSublist(w,[3,3]) = fail[104X
    [4X      and PositionSublist(w,[2,1]) = fail[104X
    [4X      and w[1] < w[lng][104X
    [4X      and w{[1,lng]} <> [1,2][104X
    [4X      and (w{[1..3]} = [1,2,3] or PositionSublist(w,[1,2,3]) = fail)[104X
    [4X    then Add(words,w); fi;[104X
    [4X  od;[104X
    [4X[104X
    [4X  words := List(words,word->Product(List(word,i->gens[i])));[104X
    [4X  return words;[104X
    [4Xend;[104X
    [4X[104X
  [4X[32X[104X
  
  [33X[0;0YNow  let's  compute  the  possible  orders  of  products  of  3,  5,  7 or 9
  generators:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XF := FreeGroup("a","b","c");;[127X[104X
    [4X[25Xgap>[125X [27Xphi := EpimorphismByGenerators(F,G);[127X[104X
    [4X[28X[ a, b, c ] -> [128X[104X
    [4X[28X[ ClassTransposition(0,x,1,x), ClassTransposition(0,x^2+1,1,x^2+1), [128X[104X
    [4X[28X  ClassTransposition(1,x,0,x^2+x) ][128X[104X
    [4X[25Xgap>[125X [27XB3 := NormedWords(F,3);[127X[104X
    [4X[28X[ a*b*c ][128X[104X
    [4X[25Xgap>[125X [27XB3 := List(B3,g->g^phi);[127X[104X
    [4X[28X[ <rcwa permutation of GF(2)[x] with modulus x^3+x> ][128X[104X
    [4X[25Xgap>[125X [27XList(B3,Order);[127X[104X
    [4X[28X[ 20 ][128X[104X
    [4X[25Xgap>[125X [27XB5 := NormedWords(F,5);[127X[104X
    [4X[28X[ a*b*c*a*c, a*b*c*b*c ][128X[104X
    [4X[25Xgap>[125X [27XB5 := List(B5,g->g^phi);[127X[104X
    [4X[28X[ <rcwa permutation of GF(2)[x] with modulus x^3+x>, [128X[104X
    [4X[28X  <rcwa permutation of GF(2)[x] with modulus x^4+x^3+x^2+x> ][128X[104X
    [4X[25Xgap>[125X [27XList(B5,Order);[127X[104X
    [4X[28X[ 12, 12 ][128X[104X
    [4X[25Xgap>[125X [27XB7 := NormedWords(F,7);[127X[104X
    [4X[28X[ a*b*c*a*c*a*c, a*b*c*a*c*b*c, a*b*c*b*c*a*c, a*b*c*b*c*b*c ][128X[104X
    [4X[25Xgap>[125X [27XB7 := List(B7,g->g^phi);[127X[104X
    [4X[28X[ <rcwa permutation of GF(2)[x] with modulus x^4+x^3+x^2+x>, [128X[104X
    [4X[28X  <rcwa permutation of GF(2)[x] with modulus x^5+x>, [128X[104X
    [4X[28X  <rcwa permutation of GF(2)[x] with modulus x^4+x^3+x^2+x>, [128X[104X
    [4X[28X  <rcwa permutation of GF(2)[x] with modulus x^5+x> ][128X[104X
    [4X[25Xgap>[125X [27XList(B7,Order);[127X[104X
    [4X[28X[ 12, 12, 12, 30 ][128X[104X
    [4X[25Xgap>[125X [27XB9 := NormedWords(F,9);[127X[104X
    [4X[28X[ a*b*c*a*b*c*a*b*c, a*b*c*a*c*a*c*a*c, a*b*c*a*c*a*c*b*c, a*b*c*a*c*b*c*a*c, [128X[104X
    [4X[28X  a*b*c*a*c*b*c*b*c, a*b*c*b*c*a*c*a*c, a*b*c*b*c*a*c*b*c, a*b*c*b*c*b*c*a*c, [128X[104X
    [4X[28X  a*b*c*b*c*b*c*b*c ][128X[104X
    [4X[25Xgap>[125X [27XB9 := List(B9,g->g^phi);;[127X[104X
    [4X[25Xgap>[125X [27XList(B9,Order);[127X[104X
    [4X[28X[ 20, 4, 30, 12, 42, 30, 4, 42, 12 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YEnter    [10XAssignGlobals(RCWALoadExamples().OddNumberOfGens_FiniteOrder);[110X   in
  order to assign the global variables defined in this section.[133X
  
  
  [1X7.9 [33X[0;0YAn abelian rcwa group over a polynomial ring[133X[101X
  
  [33X[0;0YWe enter a 2-generated abelian wild rcwa group over GF(4)[[22Xx[122X]:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xx := Indeterminate(GF(4),1);; SetName(x,"x");[127X[104X
    [4X[25Xgap>[125X [27XR := PolynomialRing(GF(4),1);[127X[104X
    [4X[28XGF(2^2)[x][128X[104X
    [4X[25Xgap>[125X [27Xe := One(GF(4));;[127X[104X
    [4X[25Xgap>[125X [27Xp := x^2 + x + e;;    q := x^2 + e;;[127X[104X
    [4X[25Xgap>[125X [27Xr := x^2 + x + Z(4);; s := x^2 + x + Z(4)^2;;[127X[104X
    [4X[25Xgap>[125X [27Xcg := List( AllResidues(R,x^2), pol -> [ p, p * pol mod q, q ] );;[127X[104X
    [4X[25Xgap>[125X [27Xch := List( AllResidues(R,x^2), pol -> [ r, r * pol mod s, s ] );;[127X[104X
    [4X[25Xgap>[125X [27Xg := RcwaMapping( R, q, cg );[127X[104X
    [4X[28X<rcwa mapping of GF(2^2)[x] with modulus x^2+1>[128X[104X
    [4X[25Xgap>[125X [27Xh := RcwaMapping( R, s, ch );[127X[104X
    [4X[28X<rcwa mapping of GF(2^2)[x] with modulus x^2+x+Z(2^2)^2>[128X[104X
    [4X[25Xgap>[125X [27XList([g,h],IsTame);[127X[104X
    [4X[28X[ false, false ][128X[104X
    [4X[25Xgap>[125X [27XG := Group(g,h);[127X[104X
    [4X[28X<rcwa group over GF(2^2)[x] with 2 generators>[128X[104X
    [4X[25Xgap>[125X [27XIsAbelian(G);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsTame(G);[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YIt  is  easy  to  see  that all orbits on GF(4)[[22Xx[122X] under the action of [10XG[110X are
  finite.[133X
  
  [33X[0;0YNow we compute the action of the group [10XG[110X on one of its orbits, and make some
  statistics of the orbits of [10XG[110X containing polynomials of degree less thanÂ 4:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xorb := Orbit(G,x^5);[127X[104X
    [4X[28X[ x^5, x^5+x^4+x^2+1, x^5+x^3+x^2+Z(2^2)*x+Z(2)^0, x^5+x^3, [128X[104X
    [4X[28X  x^5+x^4+x^3+x^2+Z(2^2)^2*x+Z(2^2)^2, x^5+x, x^5+x^4+x^3, [128X[104X
    [4X[28X  x^5+x^2+Z(2^2)^2*x, x^5+x^4+x^2+x, x^5+x^3+x^2+Z(2^2)^2*x+Z(2)^0, [128X[104X
    [4X[28X  x^5+x^4+Z(2^2)*x+Z(2^2), x^5+x^3+x, x^5+x^4+x^3+x^2+Z(2^2)*x+Z(2^2), [128X[104X
    [4X[28X  x^5+x^4+x^3+x+1, x^5+x^2+Z(2^2)*x, x^5+x^4+Z(2^2)^2*x+Z(2^2)^2 ][128X[104X
    [4X[25Xgap>[125X [27XH := Action(G,orb);[127X[104X
    [4X[28XGroup([ (1,2,4,7,6,9,12,14)(3,5,8,11,10,13,15,16), [128X[104X
    [4X[28X  (1,3,6,10)(2,5,9,13)(4,8,12,15)(7,11,14,16) ])[128X[104X
    [4X[25Xgap>[125X [27XIsAbelian(H); # check ...[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsCyclic(H);  # H, and therefore also G, is not cyclic[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27XExponent(H);[127X[104X
    [4X[28X8[128X[104X
    [4X[25Xgap>[125X [27XCollected(List(ShortOrbits(G,AllResidues(R,x^4),100),Length));[127X[104X
    [4X[28X[ [ 1, 4 ], [ 2, 6 ], [ 4, 12 ], [ 8, 24 ] ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YChanging  the generators a little changes the structure of the group and its
  action on the underlying ring a lot:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xcg[1][2] := cg[1][2] + (x^2 + e) * p * q;;[127X[104X
    [4X[25Xgap>[125X [27Xch[7][2] := ch[7][2] + x * r * s;;[127X[104X
    [4X[25Xgap>[125X [27Xg := RcwaMapping( R, q, cg );; h := RcwaMapping( R, s, ch );;[127X[104X
    [4X[25Xgap>[125X [27XG := Group(g,h);[127X[104X
    [4X[28X<rcwa group over GF(2^2)[x] with 2 generators>[128X[104X
    [4X[25Xgap>[125X [27XIsAbelian(G);[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27XSupport(G);[127X[104X
    [4X[28XGF(2^2)[x] \ [ 1, Z(2^2), Z(2^2)^2 ][128X[104X
    [4X[25Xgap>[125X [27Xorb := Orbit(G,Zero(R));;[127X[104X
    [4X[25Xgap>[125X [27XLength(orb);[127X[104X
    [4X[28X87[128X[104X
    [4X[25Xgap>[125X [27XStructureDescription(Action(G,orb));[127X[104X
    [4X[28X"A87"[128X[104X
    [4X[25Xgap>[125X [27XCollected(List(orb,DegreeOfLaurentPolynomial));[127X[104X
    [4X[28X[ [ -infinity, 1 ], [ 1, 2 ], [ 2, 4 ], [ 3, 16 ], [ 4, 64 ] ][128X[104X
    [4X[25Xgap>[125X [27XS := AllResidues(R,x^6);;[127X[104X
    [4X[25Xgap>[125X [27Xorbs := ShortOrbits(G,S,-1:finite);;[127X[104X
    [4X[25Xgap>[125X [27XList(orbs,Length);[127X[104X
    [4X[28X[ 87, 1, 1, 1, 2, 2, 2, 2, 2, 4, 4, 4, 20, 4, 12, 4, 20, 4, 4, 12, 8, 8, [128X[104X
    [4X[28X  48, 48, 16, 8, 8, 56, 8, 88, 8, 8, 8, 400, 16, 48, 16, 16, 16, 80, 16, [128X[104X
    [4X[28X  16, 16, 96, 32, 192, 32, 16, 16, 416, 16, 48, 16, 16, 880, 16, 16, 16, [128X[104X
    [4X[28X  16, 16, 16, 16, 16, 16, 848, 16, 16, 32, 16, 16, 16, 16, 16, 16, 16 ][128X[104X
    [4X[25Xgap>[125X [27XPosition(last,880);[127X[104X
    [4X[28X55[128X[104X
    [4X[25Xgap>[125X [27XSet(orbs[55],DegreeOfLaurentPolynomial); # all elm's have same degree[127X[104X
    [4X[28X[ 5 ][128X[104X
    [4X[25Xgap>[125X [27XH := Action(G,orbs[55]);;[127X[104X
    [4X[25Xgap>[125X [27XIsPrimitive(H,MovedPoints(H));[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27XList(Blocks(H,MovedPoints(H)),Length);[127X[104X
    [4X[28X[ 110, 110, 110, 110, 110, 110, 110, 110 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().AbelianGroupOverPolynomialRing);[110X  in
  order to assign the global variables defined in this section.[133X
  
  
  [1X7.10 [33X[0;0YChecking for solvability[133X[101X
  
  [33X[0;0YPresently  there is no general method available for testing wild rcwa groups
  for  solvability.  However,  sometimes  the  question for solvability can be
  answered  anyway.  In  the  example  below, the idea is to find a subgroupÂ [3XU[103X
  which  acts  on  a  finite  setÂ [3XS[103X  of  integers,  and  which  induces onÂ [3XS[103X a
  non-solvable finite permutation group:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xa := RcwaMapping([[3,0,2],[3, 1,4],[3,0,2],[3,-1,4]]);;[127X[104X
    [4X[25Xgap>[125X [27Xb := RcwaMapping([[3,0,2],[3,13,4],[3,0,2],[3,-1,4]]);;[127X[104X
    [4X[25Xgap>[125X [27XG := Group(a,b);;[127X[104X
    [4X[25Xgap>[125X [27XShortOrbits(Group(Comm(a,b)),[-10..10],100);[127X[104X
    [4X[28X[ [ -10 ], [ -9 ], [ -30, -21, -14, -13, -11, -8 ], [ -7 ], [ -6 ], [128X[104X
    [4X[28X  [ -12, -5, -4, -3, -2, 1 ], [ -1 ], [ 0 ], [ 2 ], [ 3 ], [128X[104X
    [4X[28X  [ 4, 5, 6, 7, 10, 15 ], [ 8 ], [ 9 ] ][128X[104X
    [4X[25Xgap>[125X [27XS := [ 4, 5, 6, 7, 10, 15 ];;[127X[104X
    [4X[25Xgap>[125X [27XCycle(Comm(a,b),4);[127X[104X
    [4X[28X[ 4, 7, 10, 15, 5, 6 ][128X[104X
    [4X[25Xgap>[125X [27Xelm := RepresentativeAction(G,S,Permuted(S,(1,4)),OnTuples);[127X[104X
    [4X[28X<rcwa permutation of Z with modulus 81>[128X[104X
    [4X[25Xgap>[125X [27XList(S,n->n^elm);[127X[104X
    [4X[28X[ 7, 5, 6, 4, 10, 15 ][128X[104X
    [4X[25Xgap>[125X [27XU := Group(Comm(a,b),elm);[127X[104X
    [4X[28X<rcwa group over Z with 2 generators>[128X[104X
    [4X[25Xgap>[125X [27XAction(U,S);[127X[104X
    [4X[28XGroup([ (1,4,5,6,2,3), (1,4) ])[128X[104X
    [4X[25Xgap>[125X [27XIsNaturalSymmetricGroup(last);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThus  the  subgroup  [3XU[103X  induces  on [3XS[103X a natural symmetric group of degreeÂ 6.
  Therefore the groupÂ [3XG[103X is not solvable. We conclude this example by factoring
  the group element [3Xelm[103X into generators:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XF := FreeGroup("a","b");[127X[104X
    [4X[28X<free group on the generators [ a, b ]>[128X[104X
    [4X[25Xgap>[125X [27XRepresentativeActionPreImage(G,S,Permuted(S,(1,4)),OnTuples,F);[127X[104X
    [4X[28Xa^-2*b^-2*a*b*a^-1*b*a*b^-2*a[128X[104X
    [4X[25Xgap>[125X [27Xa^-2*b^-2*a*b*a^-1*b*a*b^-2*a = elm;[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().CheckingForSolvability);[110X in order to
  assign the global variables defined in this section.[133X
  
  
  [1X7.11 [33X[0;0YSome examples over (semi)localizations of the integers[133X[101X
  
  [33X[0;0YWe  start  with  something  one  can observe when trying to [21Xtransfer[121X an rcwa
  mapping from the ring of integers to one of its localizations:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xa := RcwaMapping([[3,0,2],[3,1,4],[3,0,2],[3,-1,4]]);;[127X[104X
    [4X[25Xgap>[125X [27XIsBijective(a);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xa2 := LocalizedRcwaMapping(a,2);[127X[104X
    [4X[28X<rcwa mapping of Z_( 2 ) with modulus 4>[128X[104X
    [4X[25Xgap>[125X [27XIsSurjective(a2); # As expected[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsInjective(a2); # Why not??[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27X0^a2;[127X[104X
    [4X[28X0[128X[104X
    [4X[25Xgap>[125X [27X(1/3)^a2; # That's the reason![127X[104X
    [4X[28X0[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe  above  can also be explained easily by pointing out that the modulus of
  the  inverse  of  [10Xa[110X  isÂ 3,  and that 3 is a unit ofÂ [22Xâ„¤_(2)[122X. Moving to [22Xâ„¤_(2,3)[122X
  solves this problem:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xa23 := SemilocalizedRcwaMapping(a,[2,3]);[127X[104X
    [4X[28X<rcwa mapping of Z_( 2, 3 ) with modulus 4>[128X[104X
    [4X[25Xgap>[125X [27XIsBijective(a23);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe get additional finite cycles, e.g.:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XList(ShortOrbits(Group(a23),[0..50]/5,50),orb->Cycle(a23,orb[1]));[127X[104X
    [4X[28X[ [ 0 ], [ 1/5, 2/5, 3/5 ], [128X[104X
    [4X[28X  [ 4/5, 6/5, 9/5, 8/5, 12/5, 18/5, 27/5, 19/5, 13/5, 11/5, 7/5 ], [128X[104X
    [4X[28X  [ 1 ], [ 2, 3 ], [ 14/5, 21/5, 17/5 ], [128X[104X
    [4X[28X  [ 16/5, 24/5, 36/5, 54/5, 81/5, 62/5, 93/5, 71/5, 52/5, 78/5, 117/5, [128X[104X
    [4X[28X      89/5, 68/5, 102/5, 153/5, 116/5, 174/5, 261/5, 197/5, 149/5, [128X[104X
    [4X[28X      113/5, 86/5, 129/5, 98/5, 147/5, 109/5, 83/5, 61/5, 47/5, 34/5, [128X[104X
    [4X[28X      51/5, 37/5, 29/5, 23/5 ], [ 4, 6, 9, 7, 5 ] ][128X[104X
    [4X[25Xgap>[125X [27XList(last,Length);[127X[104X
    [4X[28X[ 1, 3, 11, 1, 2, 3, 34, 5 ][128X[104X
    [4X[25Xgap>[125X [27XList(ShortOrbits(Group(a23),[0..50]/7,50),orb->Cycle(a23,orb[1]));[127X[104X
    [4X[28X[ [ 0 ], [ -1/7, 1/7 ], [ 2/7, 3/7, 4/7, 6/7, 9/7, 5/7 ], [ 1 ], [128X[104X
    [4X[28X  [ 2, 3 ], [ 4, 6, 9, 7, 5 ] ][128X[104X
    [4X[25Xgap>[125X [27XList(last,Length);[127X[104X
    [4X[28X[ 1, 2, 6, 1, 2, 5 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YHowever  the  structure  of a group with prime set [22XP[122X remains invariant under
  the [21Xtransfer[121X from â„¤ toÂ [22Xâ„¤_(P)[122X.[133X
  
  [33X[0;0Y[21XTransferring[121X a non-invertible rcwa mapping from the ring of integers to some
  of its (semi)localizations can also turn it into an invertible one:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xv := RcwaMapping([[6,0,1],[1,-7,2],[6,0,1],[1,-1,1],[127X[104X
    [4X[25X>[125X [27X                     [6,0,1],[1, 1,2],[6,0,1],[1,-1,1]]);;[127X[104X
    [4X[25Xgap>[125X [27XDisplay(v);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa mapping of Z with modulus 8[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | 6n      if n in 0(2)[128X[104X
    [4X[28X        | n-1     if n in 3(4)[128X[104X
    [4X[28X n |-> <  (n-7)/2 if n in 1(8)[128X[104X
    [4X[28X        | (n+1)/2 if n in 5(8)[128X[104X
    [4X[28X        |[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XIsInjective(v);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsSurjective(v);[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27XImage(v);[127X[104X
    [4X[28XZ \ 4(12) U 8(12)[128X[104X
    [4X[25Xgap>[125X [27XDifference(Integers,last);[127X[104X
    [4X[28X4(12) U 8(12)[128X[104X
    [4X[25Xgap>[125X [27Xv2 := LocalizedRcwaMapping(v,2);[127X[104X
    [4X[28X<rcwa mapping of Z_( 2 ) with modulus 8>[128X[104X
    [4X[25Xgap>[125X [27XIsBijective(v2);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XDisplay(v2^-1);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of Z_( 2 ) with modulus 4[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | 1/3 n / 2 if n in 0(4)[128X[104X
    [4X[28X        | 2 n + 7   if n in 1(4)[128X[104X
    [4X[28X n |-> <  n + 1     if n in 2(4)[128X[104X
    [4X[28X        | 2 n - 1   if n in 3(4)[128X[104X
    [4X[28X        |[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XS := ResidueClass(Z_pi(2),2,0);; l := [S];;[127X[104X
    [4X[25Xgap>[125X [27Xfor i in [1..10] do Add(l,l[Length(l)]^v2); od;[127X[104X
    [4X[25Xgap>[125X [27Xl; # Visibly v2 is wild ...[127X[104X
    [4X[28X[ 0(2), 0(4), 0(8), 0(16), 0(32), 0(64), 0(128), 0(256), 0(512),[128X[104X
    [4X[28X  0(1024), 0(2048) ][128X[104X
    [4X[25Xgap>[125X [27Xw2 := RcwaMapping(Z_pi(2),[[1,0,2],[2,-1,1],[1,1,1],[2,-1,1]]);;[127X[104X
    [4X[25Xgap>[125X [27Xv2w2 := Comm(v2,w2);; v2w2^-1;;[127X[104X
    [4X[25Xgap>[125X [27XDisplay(v2w2);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of Z_( 2 ) with modulus 8[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | 3 n   if n in 2(4)[128X[104X
    [4X[28X        | n + 4 if n in 1(8)[128X[104X
    [4X[28X n |-> <  n - 4 if n in 5(8)[128X[104X
    [4X[28X        | n     if n in 0(4) U 3(4)[128X[104X
    [4X[28X        |[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YAgain, viewed as an rcwa mapping of the integers the commutator given at the
  end of the example would not be surjective.[133X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().Semilocals);[110X  in order to assign the
  global variables defined in this section.[133X
  
  
  [1X7.12 [33X[0;0YTwisting 257-cycles into an rcwa mapping with modulus 32[133X[101X
  
  [33X[0;0YWe define an rcwa mapping [3Xx[103X of orderÂ 257 with modulusÂ 32. The easiest way to
  construct  such  a  mapping  is  to prescribe a transition graph and then to
  assign suitable affine mappings to its vertices.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xx_257 := RcwaMapping([127X[104X
    [4X[25X>[125X [27X     [[ 16,  2,  1], [ 16, 18,  1], [  1, 16,  1], [ 16, 18,  1],[127X[104X
    [4X[25X>[125X [27X      [  1, 16,  1], [ 16, 18,  1], [  1, 16,  1], [ 16, 18,  1],[127X[104X
    [4X[25X>[125X [27X      [  1, 16,  1], [ 16, 18,  1], [  1, 16,  1], [ 16, 18,  1],[127X[104X
    [4X[25X>[125X [27X      [  1, 16,  1], [ 16, 18,  1], [  1, 16,  1], [ 16, 18,  1],[127X[104X
    [4X[25X>[125X [27X      [  1,  0, 16], [ 16, 18,  1], [  1,-14,  1], [ 16, 18,  1],[127X[104X
    [4X[25X>[125X [27X      [  1,-14,  1], [ 16, 18,  1], [  1,-14,  1], [ 16, 18,  1],[127X[104X
    [4X[25X>[125X [27X      [  1,-14,  1], [ 16, 18,  1], [  1,-14,  1], [ 16, 18,  1],[127X[104X
    [4X[25X>[125X [27X      [  1,-14,  1], [ 16, 18,  1], [  1,-14,  1], [  1,-31,  1]]);;[127X[104X
    [4X[25Xgap>[125X [27XOrder(x_257);; Display(x_257);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of Z with modulus 32, of order 257[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | 16n+18 if n in 1(2) \ 31(32)[128X[104X
    [4X[28X        | n+16   if n in 2(32) U 4(32) U 6(32) U 8(32) U 10(32) U [128X[104X
    [4X[28X        |                12(32) U 14(32)[128X[104X
    [4X[28X        | n-14   if n in 18(32) U 20(32) U 22(32) U 24(32) U 26(32) U [128X[104X
    [4X[28X n |-> <                 28(32) U 30(32)[128X[104X
    [4X[28X        | 16n+2  if n in 0(32)[128X[104X
    [4X[28X        | n/16   if n in 16(32)[128X[104X
    [4X[28X        | n-31   if n in 31(32)[128X[104X
    [4X[28X        |[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XLength(Cycle(x_257,0));[127X[104X
    [4X[28X257[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YEnter [10XAssignGlobals(RCWALoadExamples().LongCyclesOfPrimeLength);[110X in order to
  assign the global variables defined in this section.[133X
  
  
  [1X7.13 [33X[0;0YThe behaviour of the moduli of powers[133X[101X
  
  [33X[0;0YWe  give  some examples of how the series of the moduli of powers of a given
  rcwa mapping of the integers can look like.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xa := RcwaMapping([[3,0,2],[3, 1,4],[3,0,2],[3,-1,4]]);;[127X[104X
    [4X[25Xgap>[125X [27XList([0..4],i->Modulus(a^i));[127X[104X
    [4X[28X[ 1, 4, 16, 64, 256 ][128X[104X
    [4X[25Xgap>[125X [27Xe1 := RcwaMapping([[1,4,1],[2,0,1],[1,0,2],[2,0,1]]);;[127X[104X
    [4X[25Xgap>[125X [27Xe2 := RcwaMapping([[1,4,1],[2,0,1],[1,0,2],[1,0,1],[127X[104X
    [4X[25X>[125X [27X                      [1,4,1],[2,0,1],[1,0,1],[1,0,1]]);;[127X[104X
    [4X[25Xgap>[125X [27XList([e1,e2],Order);[127X[104X
    [4X[28X[ infinity, infinity ][128X[104X
    [4X[25Xgap>[125X [27XList([1..20],i->Modulus(e1^i));[127X[104X
    [4X[28X[ 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4 ][128X[104X
    [4X[25Xgap>[125X [27XList([1..20],i->Modulus(e2^i));[127X[104X
    [4X[28X[ 8, 4, 8, 4, 8, 4, 8, 4, 8, 4, 8, 4, 8, 4, 8, 4, 8, 4, 8, 4 ][128X[104X
    [4X[25Xgap>[125X [27XDisplay(e2);[127X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of Z with modulus 8, of order infinity[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | n+4 if n in 0(4)[128X[104X
    [4X[28X        | 2n  if n in 1(4)[128X[104X
    [4X[28X n |-> <  n/2 if n in 2(8)[128X[104X
    [4X[28X        | n   if n in 3(4) U 6(8)[128X[104X
    [4X[28X        |[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xe2^2 = Restriction(RcwaMapping([[1,2,1]]),RcwaMapping([[4,0,1]]));[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xg:=RcwaMapping([[2,2,1],[1, 4,1],[1,0,2],[2,2,1],[1,-4,1],[1,-2,1]]);;[127X[104X
    [4X[25Xgap>[125X [27Xh:=RcwaMapping([[2,2,1],[1,-2,1],[1,0,2],[2,2,1],[1,-1,1],[1, 1,1]]);;[127X[104X
    [4X[25Xgap>[125X [27XList([0..7],i->Modulus(g^i));[127X[104X
    [4X[28X[ 1, 6, 12, 12, 12, 12, 6, 1 ][128X[104X
    [4X[25Xgap>[125X [27XList([1..18],i->Modulus((g^3*h)^i));[127X[104X
    [4X[28X[ 12, 6, 12, 12, 12, 6, 12, 6, 12, 12, 12, 6, 12, 6, 12, 12, 12, 6 ][128X[104X
    [4X[25Xgap>[125X [27Xu := RcwaMapping([[3,0,5],[9,1,5],[3,-1,5],[9,-2,5],[9,4,5]]);;[127X[104X
    [4X[25Xgap>[125X [27XList([0..3],i->Modulus(u^i));[127X[104X
    [4X[28X[ 1, 5, 25, 125 ][128X[104X
    [4X[25Xgap>[125X [27Xv6 := RcwaMapping([[-1,2,1],[1,-1,1],[1,-1,1]]);;[127X[104X
    [4X[25Xgap>[125X [27XList([0..6],i->Modulus(v6^i));[127X[104X
    [4X[28X[ 1, 3, 3, 3, 3, 3, 1 ][128X[104X
    [4X[25Xgap>[125X [27Xw8 := RcwaMapping([[-1,3,1],[1,-1,1],[1,-1,1],[1,-1,1]]);;[127X[104X
    [4X[25Xgap>[125X [27XList([0..8],i->Modulus(w8^i));[127X[104X
    [4X[28X[ 1, 4, 4, 4, 4, 4, 4, 4, 1 ][128X[104X
    [4X[25Xgap>[125X [27Xz := RcwaMapping([[2,1,1],[1, 1,1],[2,-1,1],[2, -2,1],[127X[104X
    [4X[25X>[125X [27X                     [1,6,2],[1, 1,1],[1,-6,2],[2,  5,1],[127X[104X
    [4X[25X>[125X [27X                     [1,6,2],[1, 1,1],[1, 1,1],[2, -5,1],[127X[104X
    [4X[25X>[125X [27X                     [1,0,1],[1,-4,1],[1, 0,1],[2,-10,1]]);;[127X[104X
    [4X[25Xgap>[125X [27XIsBijective(z);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XList([0..25],i->Modulus(z^i));[127X[104X
    [4X[28X[ 1, 16, 32, 64, 64, 128, 128, 128, 128, 128, 128, 256, 256, 256, 256, [128X[104X
    [4X[28X  256, 256, 512, 512, 512, 512, 512, 512, 1024, 1024, 1024 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().ModuliOfPowers);[110X  in order to assign
  the global variables defined in this section.[133X
  
  
  [1X7.14 [33X[0;0YImages and preimages under the Collatz mapping[133X[101X
  
  [33X[0;0YWe  have  a look at the images of the residue class 1(2) under powers of the
  Collatz mapping.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XT := RcwaMapping([[1,0,2],[3,1,2]]);;[127X[104X
    [4X[25Xgap>[125X [27XS0 := ResidueClass(Integers,2,1);;[127X[104X
    [4X[25Xgap>[125X [27XS1 := S0^T;[127X[104X
    [4X[28X2(3)[128X[104X
    [4X[25Xgap>[125X [27XS2 := S1^T;[127X[104X
    [4X[28X1(3) U 8(9)[128X[104X
    [4X[25Xgap>[125X [27XS3 := S2^T;[127X[104X
    [4X[28X2(3) U 4(9)[128X[104X
    [4X[25Xgap>[125X [27XS4 := S3^T;[127X[104X
    [4X[28XZ \ 0(3) U 5(9)[128X[104X
    [4X[25Xgap>[125X [27XS5 := S4^T;[127X[104X
    [4X[28XZ \ 0(3) U 7(9)[128X[104X
    [4X[25Xgap>[125X [27XS6 := S5^T;[127X[104X
    [4X[28XZ \ 0(3)[128X[104X
    [4X[25Xgap>[125X [27XS7 := S6^T;[127X[104X
    [4X[28XZ \ 0(3)[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThus  the  image  gets stable after applying the mapping [22XT[122X for the 6th time.
  Hence  [22XT^6[122X  maps  the  residue class 1(2) surjectively onto the union of the
  residue classes 1(3) and 2(3), which [22XT[122X stabilizes setwise. Now we would like
  to  determine  the preimages of 1(3) and 2(3) in 1(2) under [22XT^6[122X. The residue
  class 1(2) has to be the disjoint union of these sets.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XU := Intersection(PreImage(T^6,ResidueClass(Integers,3,1)),S0);[127X[104X
    [4X[28X<union of 11 residue classes (mod 64)>[128X[104X
    [4X[25Xgap>[125X [27XV := Intersection(PreImage(T^6,ResidueClass(Integers,3,2)),S0);[127X[104X
    [4X[28X<union of 21 residue classes (mod 64)>[128X[104X
    [4X[25Xgap>[125X [27XAsUnionOfFewClasses(U);[127X[104X
    [4X[28X[ 1(64), 5(64), 7(64), 9(64), 21(64), 23(64), 29(64), 31(64), 49(64), [128X[104X
    [4X[28X  51(64), 59(64) ][128X[104X
    [4X[25Xgap>[125X [27XAsUnionOfFewClasses(V);[127X[104X
    [4X[28X[ 3(32), 11(32), 13(32), 15(32), 25(32), 17(64), 19(64), 27(64), 33(64), [128X[104X
    [4X[28X  37(64), 39(64), 41(64), 53(64), 55(64), 61(64), 63(64) ][128X[104X
    [4X[25Xgap>[125X [27XUnion(U,V) = S0 and Intersection(U,V) = [];  # consistency check[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe images of the residue class 0(3) under powers ofÂ [22XT[122X look as follows:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XS0 := ResidueClass(Integers,3,0);[127X[104X
    [4X[28X0(3)[128X[104X
    [4X[25Xgap>[125X [27XS1 := S0^T;[127X[104X
    [4X[28X0(3) U 5(9)[128X[104X
    [4X[25Xgap>[125X [27XS2 := S1^T;[127X[104X
    [4X[28X0(3) U 5(9) U 7(9) U 8(27)[128X[104X
    [4X[25Xgap>[125X [27XS3 := S2^T;[127X[104X
    [4X[28X<union of 20 residue classes (mod 27)>[128X[104X
    [4X[25Xgap>[125X [27XS4 := S3^T;[127X[104X
    [4X[28X<union of 73 residue classes (mod 81)>[128X[104X
    [4X[25Xgap>[125X [27XS5 := S4^T;[127X[104X
    [4X[28XZ \ 10(81) U 37(81)[128X[104X
    [4X[25Xgap>[125X [27XS6 := S5^T;[127X[104X
    [4X[28XIntegers[128X[104X
    [4X[25Xgap>[125X [27XS7 := S6^T;[127X[104X
    [4X[28XIntegers[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThus  every  integer  is  the image of a multiple ofÂ 3 underÂ [22XT^6[122X. This means
  that it would be sufficient to prove the [22X3n+1[122X Conjecture for multiples ofÂ 3.
  We can obtain the corresponding result for multiples ofÂ 5 as follows:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XS := [ResidueClass(Integers,5,0)];[127X[104X
    [4X[28X[ 0(5) ][128X[104X
    [4X[25Xgap>[125X [27Xfor i in [1..12] do Add(S,S[i]^T); od;[127X[104X
    [4X[25Xgap>[125X [27Xfor s in S do View(s); Print("\n"); od;[127X[104X
    [4X[28X0(5)[128X[104X
    [4X[28X0(5) U 8(15)[128X[104X
    [4X[28X0(5) U 4(15) U 8(15)[128X[104X
    [4X[28X0(5) U 2(15) U 4(15) U 8(15) U 29(45)[128X[104X
    [4X[28X<union of 73 residue classes (mod 135)>[128X[104X
    [4X[28X<union of 244 residue classes (mod 405)>[128X[104X
    [4X[28X<union of 784 residue classes (mod 1215)>[128X[104X
    [4X[28X<union of 824 residue classes (mod 1215)>[128X[104X
    [4X[28X<union of 2593 residue classes (mod 3645)>[128X[104X
    [4X[28X<union of 2647 residue classes (mod 3645)>[128X[104X
    [4X[28X<union of 2665 residue classes (mod 3645)>[128X[104X
    [4X[28X<union of 2671 residue classes (mod 3645)>[128X[104X
    [4X[28X1(3) U 2(3) U 0(15)[128X[104X
    [4X[25Xgap>[125X [27XUnion(S[13],ResidueClass(Integers,3,0));[127X[104X
    [4X[28XIntegers[128X[104X
    [4X[25Xgap>[125X [27X List(S,Si->Float(Density(Si)));[127X[104X
    [4X[28X[ 0.2, 0.266667, 0.333333, 0.422222, 0.540741, 0.602469, 0.645267, [128X[104X
    [4X[28X  0.678189, 0.711385, 0.7262, 0.731139, 0.732785, 0.733333 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().CollatzMapping);[110X  in order to assign
  the global variables defined in this section.[133X
  
  
  [1X7.15 [33X[0;0YA group which acts 4-transitively on the positive integers[133X[101X
  
  [33X[0;0YIn this section, we would like to show that the group [22XG[122X generated by the two
  wild mappings[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xa := RcwaMapping([[3,0,2],[3,1,4],[3,0,2],[3,-1,4]]);;[127X[104X
    [4X[25Xgap>[125X [27Xu := RcwaMapping([[3,0,5],[9,1,5],[3,-1,5],[9,-2,5],[9,4,5]]);;[127X[104X
    [4X[25Xgap>[125X [27XSetName(a,"a"); SetName(u,"u"); G := Group(a,u);;[127X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0Ywhich  we  have already investigated in earlier examples acts 4-transitively
  on  the  set of positive integers. Obviously, it acts on the set of positive
  integers. First we show that this action is transitive. We start by checking
  in  which residue classes sufficiently large positive integers are mapped to
  smaller ones by a suitable group element:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XList([a,a^-1,u,u^-1],DecreasingOn);[127X[104X
    [4X[28X[ 1(2), 0(3), 0(5) U 2(5), 2(3) ][128X[104X
    [4X[25Xgap>[125X [27XUnion(last);[127X[104X
    [4X[28XZ \ 4(30) U 16(30) U 28(30)[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe  see  that  we  cannot always choose such a group element from the set of
  generators and their inverses -- otherwise the union would be [10XIntegers[110X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XList([a,a^-1,u,u^-1,a^2,a^-2,u^2,u^-2],DecreasingOn);[127X[104X
    [4X[28X[ 1(2), 0(3), 0(5) U 2(5), 2(3), 1(8) U 7(8), 0(3) U 2(9) U 7(9), [128X[104X
    [4X[28X  0(25) U 12(25) U 17(25) U 20(25), 2(3) U 1(9) U 3(9) ][128X[104X
    [4X[25Xgap>[125X [27XUnion(last); # Still not enough ...[127X[104X
    [4X[28XZ \ 4(90) U 58(90) U 76(90)[128X[104X
    [4X[25Xgap>[125X [27XList([a,a^-1,u,u^-1,a^2,a^-2,u^2,u^-2,a*u,u*a,(a*u)^-1,(u*a)^-1],[127X[104X
    [4X[25X>[125X [27X        DecreasingOn);[127X[104X
    [4X[28X[ 1(2), 0(3), 0(5) U 2(5), 2(3), 1(8) U 7(8), 0(3) U 2(9) U 7(9), [128X[104X
    [4X[28X  0(25) U 12(25) U 17(25) U 20(25), 2(3) U 1(9) U 3(9), [128X[104X
    [4X[28X  3(5) U 0(10) U 7(20) U 9(20), 0(5) U 2(5), 2(3), 3(9) U 4(9) U 8(9) ][128X[104X
    [4X[25Xgap>[125X [27XUnion(last); # ... but that's it![127X[104X
    [4X[28XIntegers[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YFinally,  we  have  to deal with [21Xsmall[121X integers. We use the notation for the
  coefficients  of  rcwa  mappings introduced at the beginning of this manual.
  Let  [22Xc_r(m)  >  a_r(m)[122X.  Then we easily see that [22X(a_r(m)n+b_r(m))/c_r(m) > n[122X
  implies  [22Xn < b_r(m)/(c_r(m)-a_r(m))[122X. Thus we can restrict our considerations
  to  integers  [22Xn  <  b_  max[122X,  where  [22Xb_ max[122X is the largest second entry of a
  coefficient triple of one of the group elements in our list:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XList([a,a^-1,u,u^-1,a^2,a^-2,u^2,u^-2,a*u,u*a,(a*u)^-1,(u*a)^-1],[127X[104X
    [4X[25X>[125X [27X        f->Maximum(List(Coefficients(f),c->c[2])));[127X[104X
    [4X[28X[ 1, 1, 4, 2, 7, 7, 56, 28, 25, 17, 17, 11 ][128X[104X
    [4X[25Xgap>[125X [27XMaximum(last);[127X[104X
    [4X[28X56[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThus  this  upper  bound  is 56. The rest is easy -- all we have to do is to
  check  that the orbit containingÂ 1 contains also all other positive integers
  less than or equal toÂ 56:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XS := [1];;[127X[104X
    [4X[25Xgap>[125X [27Xwhile not IsSubset(S,[1..56]) do[127X[104X
    [4X[25X>[125X [27X     S := Union(S,S^a,S^u,S^(a^-1),S^(u^-1));[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[25Xgap>[125X [27XIsSubset(S,[1..56]);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YChecking 2-transitivity is computationally harder, and in the sequel we will
  omit  some  steps  which  are in practice needed to find out [21XwhatÂ toÂ do[121X. The
  approach  taken  here  is  to  show  that  the  stabilizer  ofÂ 1  inÂ [22XG[122X  acts
  transitively  on  the set of positive integers greater thanÂ 1. We do this by
  similar  means as used above for showing the transitivity of the action of [22XG[122X
  on  the positive integers. We start by determining all products of at most 5
  generators and their inverses, which stabilizeÂ 1 (taking at most 4-generator
  products would not suffice!):[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xgens := [a,u,a^-1,u^-1];;[127X[104X
    [4X[25Xgap>[125X [27Xtups := Concatenation(List([1..5],k->Tuples([1..4],k)));;[127X[104X
    [4X[25Xgap>[125X [27XLength(tups);[127X[104X
    [4X[28X1364[128X[104X
    [4X[25Xgap>[125X [27Xtups := Filtered(tups,tup->ForAll([[1,3],[3,1],[2,4],[4,2]],[127X[104X
    [4X[25X>[125X [27X                                     l->PositionSublist(tup,l)=fail));;[127X[104X
    [4X[25Xgap>[125X [27XLength(tups);[127X[104X
    [4X[28X484[128X[104X
    [4X[25Xgap>[125X [27Xstab := [];;[127X[104X
    [4X[25Xgap>[125X [27Xfor tup in tups do[127X[104X
    [4X[25X>[125X [27X     n := 1;[127X[104X
    [4X[25X>[125X [27X     for i in tup do n := n^gens[i]; od;[127X[104X
    [4X[25X>[125X [27X     if n = 1 then Add(stab,tup); fi;[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[25Xgap>[125X [27XLength(stab);[127X[104X
    [4X[28X118[128X[104X
    [4X[25Xgap>[125X [27Xstabelm := List(stab,tup->Product(List(tup,i->gens[i])));;[127X[104X
    [4X[25Xgap>[125X [27XForAll(stabelm,elm->1^elm=1); # Check.[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe resulting products have various different not quite small moduli:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XList(stabelm,Modulus);[127X[104X
    [4X[28X[ 4, 3, 16, 25, 9, 81, 64, 100, 108, 100, 25, 75, 27, 243, 324, 243, [128X[104X
    [4X[28X  256, 400, 144, 400, 100, 432, 324, 400, 80, 400, 625, 25, 75, 135, [128X[104X
    [4X[28X  150, 75, 225, 81, 729, 486, 729, 144, 144, 81, 729, 1296, 729, 6561, [128X[104X
    [4X[28X  1024, 1600, 192, 1600, 400, 576, 432, 1600, 320, 1600, 2500, 100, 100, [128X[104X
    [4X[28X  180, 192, 192, 108, 972, 1728, 972, 8748, 1600, 400, 320, 80, 1600, [128X[104X
    [4X[28X  2500, 300, 2500, 625, 625, 75, 675, 75, 75, 135, 405, 600, 120, 600, [128X[104X
    [4X[28X  1875, 75, 225, 405, 225, 225, 675, 243, 2187, 729, 2187, 216, 216, [128X[104X
    [4X[28X  243, 2187, 1944, 2187, 19683, 576, 144, 576, 432, 81, 81, 729, 2187, [128X[104X
    [4X[28X  5184, 324, 8748, 243, 2187, 19683, 26244, 19683 ][128X[104X
    [4X[25Xgap>[125X [27XLcm(last);[127X[104X
    [4X[28X12597120000[128X[104X
    [4X[25Xgap>[125X [27XCollected(Factors(last));[127X[104X
    [4X[28X[ [ 2, 10 ], [ 3, 9 ], [ 5, 4 ] ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YSimilar  as  before,  we determine for any of the above mappings the residue
  classes  whose  elements larger than the largest [22Xb_r(m)[122X - coefficient of the
  respective mapping are mapped to smaller integers:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xdecs := List(stabelm,DecreasingOn);;[127X[104X
    [4X[25Xgap>[125X [27XList(decs,Modulus);[127X[104X
    [4X[28X[ 2, 3, 8, 25, 9, 9, 16, 100, 12, 50, 25, 75, 27, 81, 54, 81, 64, 400, [128X[104X
    [4X[28X  48, 200, 100, 72, 108, 400, 80, 200, 625, 25, 75, 45, 75, 75, 225, 81, [128X[104X
    [4X[28X  243, 81, 243, 144, 144, 81, 243, 216, 243, 243, 128, 1600, 64, 400, [128X[104X
    [4X[28X  400, 48, 144, 1600, 320, 400, 2500, 100, 100, 60, 96, 192, 108, 324, [128X[104X
    [4X[28X  144, 324, 972, 400, 400, 80, 80, 400, 2500, 100, 1250, 625, 625, 25, [128X[104X
    [4X[28X  75, 75, 75, 45, 135, 600, 120, 150, 1875, 75, 225, 135, 225, 225, 675, [128X[104X
    [4X[28X  243, 729, 243, 729, 108, 216, 243, 729, 162, 729, 2187, 144, 144, 144, [128X[104X
    [4X[28X  144, 81, 81, 243, 729, 1296, 324, 972, 243, 729, 2187, 1458, 2187 ][128X[104X
    [4X[25Xgap>[125X [27XLcm(last);[127X[104X
    [4X[28X174960000[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YSince  the  least  common  multiple of the moduli of these unions of residue
  classes  is as large as 174960000, directly forming their union and checking
  whether  it  is equal to the set of integers would take relatively much time
  and  memory.  However, starting with the set of integers and subtracting the
  above sets one-by-one in a suitably chosen order is cheap:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XSortParallel(decs,stabelm,[127X[104X
    [4X[25X>[125X [27X     function(S1,S2)[127X[104X
    [4X[25X>[125X [27X       return First([1..100],k->Factorial(k) mod Modulus(S1)=0)[127X[104X
    [4X[25X>[125X [27X            < First([1..100],k->Factorial(k) mod Modulus(S2)=0);[127X[104X
    [4X[25X>[125X [27X     end);[127X[104X
    [4X[25Xgap>[125X [27XS := Integers;;[127X[104X
    [4X[25Xgap>[125X [27Xfor i in [1..Length(decs)] do[127X[104X
    [4X[25X>[125X [27X     S_old := S; S := Difference(S,decs[i]);[127X[104X
    [4X[25X>[125X [27X     if S <> S_old then ViewObj(S); Print("\n"); fi;[127X[104X
    [4X[25X>[125X [27X     if S = [] then maxind := i; break; fi;[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[28X0(2)[128X[104X
    [4X[28X2(6) U 4(6)[128X[104X
    [4X[28X<union of 8 residue classes (mod 30)>[128X[104X
    [4X[28X<union of 19 residue classes (mod 90)>[128X[104X
    [4X[28X<union of 114 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 99 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 57 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 54 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 41 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 35 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 8 residue classes (mod 720)>[128X[104X
    [4X[28X4(720) U 94(720) U 148(720) U 238(720)[128X[104X
    [4X[28X<union of 24 residue classes (mod 5760)>[128X[104X
    [4X[28X<union of 72 residue classes (mod 51840)>[128X[104X
    [4X[28X<union of 48 residue classes (mod 51840)>[128X[104X
    [4X[28X<union of 192 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 168 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 120 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 96 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 72 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 60 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 48 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 24 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 12 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 24 residue classes (mod 777600)>[128X[104X
    [4X[28X<union of 12 residue classes (mod 777600)>[128X[104X
    [4X[28X111604(194400) U 14404(777600) U 208804(777600)[128X[104X
    [4X[28X[  ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YSimilar as above, it remains to check that the [21Xsmall[121X integers all lie in the
  orbit  containingÂ 2.  Obviously,  it is sufficient to check that any integer
  greater thanÂ 2 is mapped to a smaller one by some suitably chosen element of
  the stabilizer under consideration:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XMaximum(List(stabelm{[1..maxind]},[127X[104X
    [4X[25X>[125X [27X                f->Maximum(List(Coefficients(f),c->c[2]))));[127X[104X
    [4X[28X6581[128X[104X
    [4X[25Xgap>[125X [27XFiltered([3..6581],n->Minimum(List(stabelm,elm->n^elm))>=n);[127X[104X
    [4X[28X[ 4 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe have to treat 4 separately:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27X1^(u*a*u^2*a^-1*u);[127X[104X
    [4X[28X1[128X[104X
    [4X[25Xgap>[125X [27X4^(u*a*u^2*a^-1*u);[127X[104X
    [4X[28X3[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YNow  we know that any positive integer greater thanÂ 1 lies in the same orbit
  under the action of the stabilizer ofÂ 1 inÂ [22XG[122X asÂ 2, thus that this stabilizer
  acts  transitively  on  [22Xâ„• âˆ– {1}[122X. But this means that we have established the
  2-transitivity of the action of [22XG[122X onÂ â„•.[133X
  
  [33X[0;0YIn  the  following,  we essentially repeat the above steps to show that this
  action is indeed 3-transitive:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xtups := Concatenation(List([1..6],k->Tuples([1..4],k)));;[127X[104X
    [4X[25Xgap>[125X [27Xtups := Filtered(tups,tup->ForAll([[1,3],[3,1],[2,4],[4,2]],[127X[104X
    [4X[25X>[125X [27X                                     l->PositionSublist(tup,l)=fail));;[127X[104X
    [4X[25Xgap>[125X [27Xstab := [];;[127X[104X
    [4X[25Xgap>[125X [27Xfor tup in tups do[127X[104X
    [4X[25X>[125X [27X     l := [1,2];[127X[104X
    [4X[25X>[125X [27X     for i in tup do l := List(l,n->n^gens[i]); od;[127X[104X
    [4X[25X>[125X [27X     if l = [1,2] then Add(stab,tup); fi;[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[25Xgap>[125X [27XLength(stab);[127X[104X
    [4X[28X212[128X[104X
    [4X[25Xgap>[125X [27Xstabelm := List(stab,tup->Product(List(tup,i->gens[i])));;[127X[104X
    [4X[25Xgap>[125X [27Xdecs := List(stabelm,DecreasingOn);;[127X[104X
    [4X[25Xgap>[125X [27XSortParallel(decs,stabelm,function(S1,S2)[127X[104X
    [4X[25X>[125X [27X     return First([1..100],k->Factorial(k) mod Mod(S1)=0)[127X[104X
    [4X[25X>[125X [27X          < First([1..100],k->Factorial(k) mod Mod(S2)=0); end);[127X[104X
    [4X[25Xgap>[125X [27XS := Integers;;[127X[104X
    [4X[25Xgap>[125X [27Xfor i in [1..Length(decs)] do[127X[104X
    [4X[25X>[125X [27X     S_old := S; S := Difference(S,decs[i]);[127X[104X
    [4X[25X>[125X [27X     if S <> S_old then ViewObj(S); Print("\n"); fi;[127X[104X
    [4X[25X>[125X [27X     if S = [] then break; fi;[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[28XZ \ 1(8) U 7(8)[128X[104X
    [4X[28X<union of 151 residue classes (mod 240)>[128X[104X
    [4X[28X<union of 208 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 51 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 45 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 39 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 33 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 23 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 19 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 17 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 16 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 14 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 8 residue classes (mod 720)>[128X[104X
    [4X[28X<union of 7 residue classes (mod 720)>[128X[104X
    [4X[28X238(360) U 4(720) U 148(720) U 454(720)[128X[104X
    [4X[28X<union of 38 residue classes (mod 5760)>[128X[104X
    [4X[28X<union of 37 residue classes (mod 5760)>[128X[104X
    [4X[28X<union of 25 residue classes (mod 5760)>[128X[104X
    [4X[28X<union of 21 residue classes (mod 5760)>[128X[104X
    [4X[28X<union of 17 residue classes (mod 5760)>[128X[104X
    [4X[28X<union of 16 residue classes (mod 5760)>[128X[104X
    [4X[28X<union of 138 residue classes (mod 51840)>[128X[104X
    [4X[28X<union of 48 residue classes (mod 51840)>[128X[104X
    [4X[28X<union of 32 residue classes (mod 51840)>[128X[104X
    [4X[28X<union of 20 residue classes (mod 51840)>[128X[104X
    [4X[28X<union of 16 residue classes (mod 51840)>[128X[104X
    [4X[28X<union of 68 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 42 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 32 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 26 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 25 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 11 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 10 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 7 residue classes (mod 259200)>[128X[104X
    [4X[28X13414(129600) U 2164(259200) U 66964(259200) U 228964(259200)[128X[104X
    [4X[28X2164(259200) U 66964(259200) U 228964(259200)[128X[104X
    [4X[28X[  ][128X[104X
    [4X[25Xgap>[125X [27XMaximum(List(stabelm,f->Maximum(List(Coefficients(f),c->c[2]))));[127X[104X
    [4X[28X515816[128X[104X
    [4X[25Xgap>[125X [27Xsmallnum := [4..515816];;[127X[104X
    [4X[25Xgap>[125X [27Xfor i in [1..Length(stabelm)] do[127X[104X
    [4X[25X>[125X [27X     smallnum := Filtered(smallnum,n->n^stabelm[i]>=n);[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[25Xgap>[125X [27Xsmallnum;[127X[104X
    [4X[28X[  ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe same for 4-transitivity:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xtups := Concatenation(List([1..8],k->Tuples([1..4],k)));;[127X[104X
    [4X[25Xgap>[125X [27Xtups := Filtered(tups,tup->ForAll([[1,3],[3,1],[2,4],[4,2]],[127X[104X
    [4X[25X>[125X [27X                                     l->PositionSublist(tup,l)=fail));;[127X[104X
    [4X[25Xgap>[125X [27Xstab := [];;[127X[104X
    [4X[25Xgap>[125X [27Xfor tup in tups do[127X[104X
    [4X[25X>[125X [27X     l := [1,2,3];[127X[104X
    [4X[25X>[125X [27X     for i in tup do l := List(l,n->n^gens[i]); od;[127X[104X
    [4X[25X>[125X [27X     if l = [1,2,3] then Add(stab,tup); fi;[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[25Xgap>[125X [27XLength(stab);[127X[104X
    [4X[28X528[128X[104X
    [4X[25Xgap>[125X [27Xstabelm := [];;[127X[104X
    [4X[25Xgap>[125X [27Xfor i in [1..Length(stab)] do[127X[104X
    [4X[25X>[125X [27X     elm := One(G);[127X[104X
    [4X[25X>[125X [27X     for j in stab[i] do[127X[104X
    [4X[25X>[125X [27X       if Modulus(elm) > 10000 then elm := fail; break; fi;[127X[104X
    [4X[25X>[125X [27X       elm := elm * gens[j];[127X[104X
    [4X[25X>[125X [27X     od;[127X[104X
    [4X[25X>[125X [27X     if elm <> fail then Add(stabelm,elm); fi;[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[25Xgap>[125X [27XLength(stabelm);[127X[104X
    [4X[28X334[128X[104X
    [4X[25Xgap>[125X [27Xdecs := List(stabelm,DecreasingOn);;[127X[104X
    [4X[25Xgap>[125X [27XSortParallel(decs,stabelm,[127X[104X
    [4X[25X>[125X [27X     function(S1,S2)[127X[104X
    [4X[25X>[125X [27X       return First([1..100],k->Factorial(k) mod Modulus(S1) = 0)[127X[104X
    [4X[25X>[125X [27X            < First([1..100],k->Factorial(k) mod Modulus(S2) = 0);[127X[104X
    [4X[25X>[125X [27X     end);[127X[104X
    [4X[25Xgap>[125X [27XS := Integers;;[127X[104X
    [4X[25Xgap>[125X [27Xfor i in [1..Length(decs)] do[127X[104X
    [4X[25X>[125X [27X     S_old := S; S := Difference(S,decs[i]);[127X[104X
    [4X[25X>[125X [27X     if S <> S_old then ViewObj(S); Print("\n"); fi;[127X[104X
    [4X[25X>[125X [27X     if S = [] then maxind := i; break; fi;[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[28XZ \ 1(8) U 7(8)[128X[104X
    [4X[28X<union of 46 residue classes (mod 72)>[128X[104X
    [4X[28X<union of 20 residue classes (mod 72)>[128X[104X
    [4X[28X4(18)[128X[104X
    [4X[28X<union of 28 residue classes (mod 576)>[128X[104X
    [4X[28X<union of 22 residue classes (mod 576)>[128X[104X
    [4X[28X<union of 21 residue classes (mod 576)>[128X[104X
    [4X[28X40(72) U 4(144) U 94(144) U 346(576) U 418(576)[128X[104X
    [4X[28X<union of 16 residue classes (mod 576)>[128X[104X
    [4X[28X<union of 15 residue classes (mod 576)>[128X[104X
    [4X[28X4(144) U 94(144) U 346(576) U 418(576)[128X[104X
    [4X[28X<union of 30 residue classes (mod 5184)>[128X[104X
    [4X[28X<union of 26 residue classes (mod 5184)>[128X[104X
    [4X[28X<union of 6 residue classes (mod 1296)>[128X[104X
    [4X[28X<union of 504 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 324 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 282 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 239 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 218 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 194 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 154 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 97 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 85 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 77 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 67 residue classes (mod 129600)>[128X[104X
    [4X[28X<union of 125 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 108 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 107 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 101 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 100 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 84 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 80 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 76 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 70 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 66 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 54 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 53 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 47 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 43 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 31 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 24 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 23 residue classes (mod 259200)>[128X[104X
    [4X[28X<union of 13 residue classes (mod 259200)>[128X[104X
    [4X[28X57406(129600) U 115006(129600) U 192676(259200) U 250276(259200)[128X[104X
    [4X[28X57406(129600) U 192676(259200) U 250276(259200) U 374206(388800)[128X[104X
    [4X[28X57406(129600) U 192676(259200) U 250276(259200)[128X[104X
    [4X[28X250276(259200) U 57406(388800) U 316606(388800) U 451876(777600)[128X[104X
    [4X[28X316606(388800) U 451876(777600) U 509476(777600) U 768676(777600)[128X[104X
    [4X[28X<union of 18 residue classes (mod 3110400)>[128X[104X
    [4X[28X451876(777600) U 509476(777600) U 705406(777600) U 768676(777600)[128X[104X
    [4X[28X U 2649406(3110400)[128X[104X
    [4X[28X451876(777600) U 705406(777600) U 768676(777600) U 2649406(3110400)[128X[104X
    [4X[28X451876(777600) U 705406(777600) U 2649406(3110400)[128X[104X
    [4X[28X705406(777600) U 2007076(3110400) U 2649406(3110400) U 2784676(3110400)[128X[104X
    [4X[28X<union of 14 residue classes (mod 9331200)>[128X[104X
    [4X[28X2260606(2332800) U 5759806(9331200) U 5895076(9331200) U 8227876(9331200)[128X[104X
    [4X[28X4593406(6998400) U 15091006(27993600) U 17559076(27993600)[128X[104X
    [4X[28X U 24557476(27993600)[128X[104X
    [4X[28X<union of 14 residue classes (mod 83980800)>[128X[104X
    [4X[28X18590206(20995200) U 24557476(83980800) U 45552676(83980800)[128X[104X
    [4X[28X U 71078206(83980800)[128X[104X
    [4X[28X[  ][128X[104X
    [4X[25Xgap>[125X [27XMaximum(List(stabelm{[1..maxind]},[127X[104X
    [4X[25X>[125X [27X                f->Maximum(List(Coefficients(f),c->c[2]))));[127X[104X
    [4X[28X58975[128X[104X
    [4X[25Xgap>[125X [27Xsmallnum := [5..58975];;[127X[104X
    [4X[25Xgap>[125X [27Xfor i in [1..maxind] do[127X[104X
    [4X[25X>[125X [27X     smallnum := Filtered(smallnum,n->n^stabelm[i]>=n);[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[25Xgap>[125X [27Xsmallnum;[127X[104X
    [4X[28X[  ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThere is even some evidence that the degree of transitivity of the action of
  [22XG[122X on the positive integers is higher thanÂ 4:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xphi := EpimorphismFromFreeGroup(G);[127X[104X
    [4X[28X[ a, u ] -> [ a, u ][128X[104X
    [4X[25Xgap>[125X [27XF := Source(phi);[127X[104X
    [4X[28X<free group on the generators [ a, u ]>[128X[104X
    [4X[25Xgap>[125X [27XList([5..20],[127X[104X
    [4X[25X>[125X [27X        n->RepresentativeActionPreImage(G,[1,2,3,4,5],[127X[104X
    [4X[25X>[125X [27X                                          [1,2,3,4,n],OnTuples,F));[127X[104X
    [4X[28X[ <identity ...>, a^-3*u^4*a*u^-2*a^2, [128X[104X
    [4X[28X  a^-2*u*a^-1*u*a^-1*u*a^-1*u*a^-1*u^-1*a, a^4*u^-2*a^-4, a^-1*u^-4*a, [128X[104X
    [4X[28X  u^2*a^-1*u^2*a^-1*u^-2, u^-2*a^-2*u^4, a^-1*u^2*a, a^-1*u^-6*a, [128X[104X
    [4X[28X  a^2*u^4*a^2*u^2, u^-4*a*u^-2*a^-3, a^-1*u^-2*a^-3*u^4*a^2, [128X[104X
    [4X[28X  a^3*u^2*a*u^2, a*u^-4*a*u^-4*a^-2, u^-2*a*u^2*a*u^-2, u^-4*a^2*u^2 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YEnter [10XAssignGlobals(RCWALoadExamples().CollatzlikePerms);[110X in order to assign
  the global variables defined in this section.[133X
  
  
  [1X7.16 [33X[0;0YA group which acts 3-transitively, but not 4-transitively on â„¤[133X[101X
  
  [33X[0;0YIn  this  section,  we would like to show that the wild group [22XG[122X generated by
  the two tame mappings [22Xn â†¦ n + 1[122X and [22XÏ„_1(2),0(4)[122X acts 3-transitively, but not
  4-transitively on the set of integers.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XG := Group(ClassShift(0,1),ClassTransposition(1,2,0,4));[127X[104X
    [4X[28X<rcwa group over Z with 2 generators>[128X[104X
    [4X[25Xgap>[125X [27XIsTame(G);[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27X(G.1^-2*G.2)^3*(G.1^2*G.2)^3; # G <> the free product C_infty * C_2.[127X[104X
    [4X[28XIdentityMapping( Integers )[128X[104X
    [4X[25Xgap>[125X [27XDisplay(G);[127X[104X
    [4X[28X[128X[104X
    [4X[28XWild rcwa group over Z, generated by[128X[104X
    [4X[28X[128X[104X
    [4X[28X[[128X[104X
    [4X[28XTame rcwa permutation of Z: n -> n + 1[128X[104X
    [4X[28X[128X[104X
    [4X[28XRcwa permutation of Z with modulus 4, of order 2[128X[104X
    [4X[28X[128X[104X
    [4X[28X        /[128X[104X
    [4X[28X        | 2n-2    if n in 1(2)[128X[104X
    [4X[28X n |-> <  (n+2)/2 if n in 0(4)[128X[104X
    [4X[28X        | n       if n in 2(4)[128X[104X
    [4X[28X        \[128X[104X
    [4X[28X[128X[104X
    [4X[28X][128X[104X
    [4X[28X[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThis  group acts transitively onÂ â„¤, since already the cyclic group generated
  by  the  first  of  the two generators does so. Next we have to show that it
  acts  2-transitively.  We  essentially  proceed  as  in  the  example in the
  previous  section, by checking that the stabilizer ofÂ 0 acts transitively on
  [22Xâ„¤ âˆ– {0}[122X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xgens := [ClassShift(0,1)^-1,ClassTransposition(1,2,0,4),ClassShift(0,1)];;[127X[104X
    [4X[25Xgap>[125X [27Xtups := Concatenation(List([1..6],k->Tuples([-1,0,1],k)));;[127X[104X
    [4X[25Xgap>[125X [27Xtups := Filtered(tups,tup->ForAll([[0,0],[-1,1],[1,-1]],[127X[104X
    [4X[25X>[125X [27X                                     l->PositionSublist(tup,l)=fail));;[127X[104X
    [4X[25Xgap>[125X [27XLength(tups);[127X[104X
    [4X[28X189[128X[104X
    [4X[25Xgap>[125X [27Xstab := [];;[127X[104X
    [4X[25Xgap>[125X [27Xfor tup in tups do[127X[104X
    [4X[25X>[125X [27X     n := 0;[127X[104X
    [4X[25X>[125X [27X     for i in tup do n := n^gens[i+2]; od;[127X[104X
    [4X[25X>[125X [27X     if n = 0 then Add(stab,tup); fi;[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[25Xgap>[125X [27Xstabelm := List(stab,tup->Product(List(tup,i->gens[i+2])));;[127X[104X
    [4X[25Xgap>[125X [27XCollected(List(stabelm,Modulus));[127X[104X
    [4X[28X[ [ 4, 6 ], [ 8, 4 ], [ 16, 3 ] ][128X[104X
    [4X[25Xgap>[125X [27Xdecs := List(stabelm,DecreasingOn);[127X[104X
    [4X[28X[ 0(4), 3(4), 0(4), 3(4), 2(4), 0(4), 4(8), 2(4), 2(4), 0(4), 1(4), [128X[104X
    [4X[28X  0(8), 3(8) ][128X[104X
    [4X[25Xgap>[125X [27XUnion(decs);[127X[104X
    [4X[28XIntegers[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YSimilar  as  in  the previous section, it remains to check that the integers
  with [21Xsmall[121X absolute value all lie in the orbit containingÂ 1 under the action
  of the stabilizer ofÂ 0:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XMaximum(List(stabelm,f->Maximum(List(Coefficients(f),c->AbsInt(c[2])))));[127X[104X
    [4X[28X21[128X[104X
    [4X[25Xgap>[125X [27XS := [1];;[127X[104X
    [4X[25Xgap>[125X [27Xfor elm in stabelm do S := Union(S,S^elm,S^(elm^-1)); od;[127X[104X
    [4X[25Xgap>[125X [27XIsSubset(S,Difference([-21..21],[0])); # Not yet ..[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27Xfor elm in stabelm do S := Union(S,S^elm,S^(elm^-1)); od;[127X[104X
    [4X[25Xgap>[125X [27XIsSubset(S,Difference([-21..21],[0])); # ... but now![127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YNow  we  have  to  check  for 3-transitivity. Since we cannot find for every
  residue class an element of the pointwise stabilizer of [22X{0,1}[122X which properly
  divides  its  elements, we also have to take additions and subtractions into
  consideration.  Since the moduli of all of our stabilizer elements are quite
  small, simply looking at sets of representatives is cheap:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xtups := Concatenation(List([1..10],k->Tuples([-1,0,1],k)));;[127X[104X
    [4X[25Xgap>[125X [27Xtups := Filtered(tups,tup->ForAll([[0,0],[-1,1],[1,-1]],[127X[104X
    [4X[25X>[125X [27X                                     l->PositionSublist(tup,l)=fail));;[127X[104X
    [4X[25Xgap>[125X [27XLength(tups);[127X[104X
    [4X[28X3069[128X[104X
    [4X[25Xgap>[125X [27Xstab := [];;[127X[104X
    [4X[25Xgap>[125X [27Xfor tup in tups do[127X[104X
    [4X[25X>[125X [27X     l := [0,1];[127X[104X
    [4X[25X>[125X [27X     for i in tup do l := List(l,n->n^gens[i+2]); od;[127X[104X
    [4X[25X>[125X [27X     if l = [0,1] then Add(stab,tup); fi;[127X[104X
    [4X[25X>[125X [27X   od;[127X[104X
    [4X[25Xgap>[125X [27XLength(stab);[127X[104X
    [4X[28X10[128X[104X
    [4X[25Xgap>[125X [27Xstabelm := List(stab,tup->Product(List(tup,i->gens[i+2])));;[127X[104X
    [4X[25Xgap>[125X [27XMaximum(List(stabelm,Modulus));[127X[104X
    [4X[28X8[128X[104X
    [4X[25Xgap>[125X [27XMaximum(List(stabelm,[127X[104X
    [4X[25X>[125X [27X                f->Maximum(List(Coefficients(f),c->AbsInt(c[2])))));[127X[104X
    [4X[28X8[128X[104X
    [4X[25Xgap>[125X [27Xdecsp := List(stabelm,elm->Filtered([9..16],n->n^elm<n));[127X[104X
    [4X[28X[ [ 9, 13 ], [ 10, 12, 14, 16 ], [ 12, 16 ], [ 9, 13 ], [ 12, 16 ], [128X[104X
    [4X[28X  [ 9, 11, 13, 15 ], [ 9, 11, 13, 15 ], [ 12, 16 ], [ 12, 16 ], [128X[104X
    [4X[28X  [ 9, 11, 13, 15 ] ][128X[104X
    [4X[25Xgap>[125X [27XUnion(decsp);[127X[104X
    [4X[28X[ 9, 10, 11, 12, 13, 14, 15, 16 ][128X[104X
    [4X[25Xgap>[125X [27Xdecsm := List(stabelm,elm->Filtered([-16..-9],n->n^elm>n));[127X[104X
    [4X[28X[ [ -15, -13, -11, -9 ], [ -16, -12 ], [ -16, -12 ], [ -15, -11 ], [128X[104X
    [4X[28X  [ -16, -14, -12, -10 ], [ -15, -11 ], [ -15, -11 ], [128X[104X
    [4X[28X  [ -16, -14, -12, -10 ], [ -16, -14, -12, -10 ], [ -15, -11 ] ][128X[104X
    [4X[25Xgap>[125X [27XUnion(decsm);[127X[104X
    [4X[28X[ -16, -15, -14, -13, -12, -11, -10, -9 ][128X[104X
    [4X[25Xgap>[125X [27XS := [2];;[127X[104X
    [4X[25Xgap>[125X [27Xfor elm in stabelm do S := Union(S,S^elm,S^(elm^-1)); od;[127X[104X
    [4X[25Xgap>[125X [27XIsSubset(S,Difference([-8..8],[0,1]));[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YAt  this  point we have established 3-transitivity. It remains to check that
  the  group  [22XG[122X does not act 4-transitively. We do this by checking that it is
  not  transitive on 4-tuples (modÂ 4). Since [22Xn[122XÂ modÂ 8 determines the image of [22Xn[122X
  under a generator of [22XG[122X (modÂ 4), it suffices to compute (modÂ 8):[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xorb := [[0,1,2,3]];;[127X[104X
    [4X[25Xgap>[125X [27Xextend := function ()[127X[104X
    [4X[25X>[125X [27X     local gen;[127X[104X
    [4X[25X>[125X [27X     for gen in gens do[127X[104X
    [4X[25X>[125X [27X       orb := Union(orb,List(orb,l->List(l,n->n^gen) mod 8));[127X[104X
    [4X[25X>[125X [27X     od;[127X[104X
    [4X[25X>[125X [27X   end;;[127X[104X
    [4X[25Xgap>[125X [27Xrepeat[127X[104X
    [4X[25X>[125X [27X     old := ShallowCopy(orb);[127X[104X
    [4X[25X>[125X [27X     extend(); Print(Length(orb),"\n");[127X[104X
    [4X[25X>[125X [27X   until orb = old;[127X[104X
    [4X[28X7[128X[104X
    [4X[28X27[128X[104X
    [4X[28X97[128X[104X
    [4X[28X279[128X[104X
    [4X[28X573[128X[104X
    [4X[28X916[128X[104X
    [4X[28X1185[128X[104X
    [4X[28X1313[128X[104X
    [4X[28X1341[128X[104X
    [4X[28X1344[128X[104X
    [4X[28X1344[128X[104X
    [4X[25Xgap>[125X [27XLength(Set(List(orb,l->l mod 4)));[127X[104X
    [4X[28X120[128X[104X
    [4X[25Xgap>[125X [27Xlast < 4^4;[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThis   shows   that  [22XG[122X  acts  not  4-transitively  onÂ â„¤.  The  corresponding
  calculation for 3-tuples looks as follows:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xorb := [[0,1,2]];;[127X[104X
    [4X[25Xgap>[125X [27Xrepeat[127X[104X
    [4X[25X>[125X [27X     old := ShallowCopy(orb);[127X[104X
    [4X[25X>[125X [27X     extend(); Print(Length(orb),"\n");[127X[104X
    [4X[25X>[125X [27X   until orb = old;[127X[104X
    [4X[28X7[128X[104X
    [4X[28X27[128X[104X
    [4X[28X84[128X[104X
    [4X[28X207[128X[104X
    [4X[28X363[128X[104X
    [4X[28X459[128X[104X
    [4X[28X503[128X[104X
    [4X[28X512[128X[104X
    [4X[28X512[128X[104X
    [4X[25Xgap>[125X [27XLength(Set(List(orb,l->l mod 4)));[127X[104X
    [4X[28X64[128X[104X
    [4X[25Xgap>[125X [27Xlast = 4^3;[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YNeedless  to  say  that the latter kind of argumentation is not suitable for
  proving, but only for disproving [22Xk[122X-transitivity.[133X
  
  
  [1X7.17 [33X[0;0YFinite quotients of Grigorchuk groups[133X[101X
  
  [33X[0;0YIn  this  section,  we  show  how  to  construct finite quotients of the two
  infinite  periodic groups introduced by Rostislav Grigorchuk inÂ [Gri80] with
  the help of [5XRCWA[105X. The first of these, nowadays known as [21XGrigorchuk group[121X, is
  investigated   in   an   example   given   on   the   [5XGAP[105X   website  --  see
  [7Xhttp://www.gap-system.org/Doc/Examples/grigorchuk.html[107X.   The  [5XRCWA[105X  package
  permits  a  simpler and more elegant construction of the finite quotients of
  this  group:  The  function  [10XTopElement[110X  given on the mentioned webpage gets
  unnecessary, and the function [10XSequenceElement[110X can be simplified as follows:[133X
  
  [4X[32X[104X
    [4X[104X
    [4XSequenceElement := function ( r, level )[104X
    [4X[104X
    [4X  return Permutation(Product(Filtered([1..level-1],k->k mod 3 <> r),[104X
    [4X                             k->ClassTransposition(    2^(k-1)-1,2^(k+1),[104X
    [4X                                                   2^k+2^(k-1)-1,2^(k+1))),[104X
    [4X                     [0..2^level-1]);[104X
    [4Xend;[104X
    [4X[104X
  [4X[32X[104X
  
  [33X[0;0YThe actual constructors for the generators are modified as follows:[133X
  
  [4X[32X[104X
    [4X[104X
    [4Xa := level -> Permutation(ClassTransposition(0,2,1,2),[0..2^level-1]);[104X
    [4Xb := level -> SequenceElement(0,level);[104X
    [4Xc := level -> SequenceElement(2,level);[104X
    [4Xd := level -> SequenceElement(1,level);[104X
    [4X[104X
  [4X[32X[104X
  
  [33X[0;0YAll  computations  given  on  the  webpage  can now be done just as with the
  [21Xoriginal[121X  construction  of  the  quotients  of  the Grigorchuk group. In the
  sequel,  we  construct  finite  quotients  of  the  second  group introduced
  inÂ [Gri80]:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XFourCycle := RcwaMapping((4,5,6,7),[4..7]);[127X[104X
    [4X[28X<rcwa permutation of Z with modulus 4, of order 4>[128X[104X
    [4X[25Xgap>[125X [27XGrigorchukGroup2Generator := function ( level )[127X[104X
    [4X[25X>[125X [27X     if level = 1 then return FourCycle; else[127X[104X
    [4X[25X>[125X [27X       return   Restriction(FourCycle, RcwaMapping([[4,1,1]]))[127X[104X
    [4X[25X>[125X [27X              * Restriction(FourCycle, RcwaMapping([[4,3,1]]))[127X[104X
    [4X[25X>[125X [27X              * Restriction(GrigorchukGroup2Generator(level-1),[127X[104X
    [4X[25X>[125X [27X                            RcwaMapping([[4,0,1]]));[127X[104X
    [4X[25X>[125X [27X     fi;[127X[104X
    [4X[25X>[125X [27X   end;;[127X[104X
    [4X[25Xgap>[125X [27XGrigorchukGroup2 := level -> Group(FourCycle,[127X[104X
    [4X[25X>[125X [27X                                      GrigorchukGroup2Generator(level));;[127X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe  can do similar things as shown in the example on the [5XGAP[105X webpage for the
  [21Xfirst[121X Grigorchuk group:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XG := List([1..4],lev->GrigorchukGroup2(lev)); # The first 4 quotients.[127X[104X
    [4X[28X[ <rcwa group over Z with 2 generators>, [128X[104X
    [4X[28X  <rcwa group over Z with 2 generators>, [128X[104X
    [4X[28X  <rcwa group over Z with 2 generators>, [128X[104X
    [4X[28X  <rcwa group over Z with 2 generators> ][128X[104X
    [4X[25Xgap>[125X [27XH := List([1..4],lev->Action(G[lev],[0..4^lev-1])); # Isom. perm.-gps.[127X[104X
    [4X[28X[ Group([ (1,2,3,4), (1,2,3,4) ]), [128X[104X
    [4X[28X  Group([ (1,2,3,4)(5,6,7,8)(9,10,11,12)(13,14,15,16), [128X[104X
    [4X[28X      (1,5,9,13)(2,6,10,14)(4,8,12,16) ]), [128X[104X
    [4X[28X  <permutation group with 2 generators>, [128X[104X
    [4X[28X  <permutation group with 2 generators> ][128X[104X
    [4X[25Xgap>[125X [27XList(H,Size);[127X[104X
    [4X[28X[ 4, 1024, 4294967296, 1329227995784915872903807060280344576 ][128X[104X
    [4X[25Xgap>[125X [27XList(last,n->Collected(Factors(n)));[127X[104X
    [4X[28X[ [ [ 2, 2 ] ], [ [ 2, 10 ] ], [ [ 2, 32 ] ], [ [ 2, 120 ] ] ][128X[104X
    [4X[25Xgap>[125X [27XList(H,NilpotencyClassOfGroup);      [127X[104X
    [4X[28X[ 1, 6, 14, 40 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().GrigorchukQuotients);[110X  in  order  to
  assign the global variables defined in this section.[133X
  
  
  [1X7.18 [33X[0;0YForward orbits of a monoid with 2 generators[133X[101X
  
  [33X[0;0YThe  [22X3n+1[122X  Conjecture asserts that the forward orbit of any positive integer
  under  the  Collatz  mapping [22XT[122X containsÂ 1. In contrast, it seems likely that
  [21Xmost[121X trajectories of the two mappings[133X
  
                                        /
                                        | n/2          if n even,
            T_5+/-:  Z -> Z,   n  |->  <
                                        | (5n +/- 1)/2 if n odd
                                        \
  
  [33X[0;0Ydiverge.  However we can show by means of computation that the forward orbit
  of  any positive integer under the action of the monoid generated by the two
  mappings  [22XT_5^-[122X  andÂ [22XT_5^+[122X  indeed  containsÂ 1.  First  of all, we enter the
  generators:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XT5m := RcwaMapping([[1,0,2],[5,-1,2]]);;[127X[104X
    [4X[25Xgap>[125X [27XT5p := RcwaMapping([[1,0,2],[5, 1,2]]);;[127X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe  look  for  a  number [22Xk[122X such that for any residue class [22Xr(2^k)[122X there is a
  productÂ [22Xf[122X  of  [22Xk[122XÂ mappings  [22XT_5^Â±[122X whose restriction to [22Xr(2^k)[122X is given by [22Xn â†¦
  (an+b)/c[122X where [22Xc>a[122X:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xk := 1;;[127X[104X
    [4X[25Xgap>[125X [27Xrepeat[127X[104X
    [4X[25X>[125X [27X     maps := List(Tuples([T5m,T5p],k),Product);[127X[104X
    [4X[25X>[125X [27X     decr := List(maps,DecreasingOn);[127X[104X
    [4X[25X>[125X [27X     decreasable := Union(decr);[127X[104X
    [4X[25X>[125X [27X     Print(k,": "); View(decreasable); Print("\n");[127X[104X
    [4X[25X>[125X [27X     k := k + 1;[127X[104X
    [4X[25X>[125X [27X   until decreasable = Integers;[127X[104X
    [4X[28X1: 0(2)[128X[104X
    [4X[28X2: 0(4)[128X[104X
    [4X[28X3: Z \ 1(8) U 7(8)[128X[104X
    [4X[28X4: 0(4) U 3(16) U 6(16) U 10(16) U 13(16)[128X[104X
    [4X[28X5: Z \ 7(32) U 25(32)[128X[104X
    [4X[28X6: <union of 48 residue classes (mod 64)>[128X[104X
    [4X[28X7: Integers[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThus [22Xk=7[122X serves our purposes. To be sure that for any positive integer [22Xn[122X our
  monoid  contains  a  mapping  [22Xf[122X such that [22Xn^f<n[122X, we still need to check this
  condition for [21Xsmall[121XÂ [22Xn[122X. Since in case [22Xc>a[122X we have [22X(an+b)/c â‰¥ n[122X if only if [22Xn â‰¤
  b/(c-a)[122X, we only need to check those [22Xn[122X which are not larger than the largest
  coefficient [22Xb_r(m)[122X occurring in any of the products under consideration:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xmaxb := Maximum(List(maps,f->Maximum(List(Coefficients(f),t->t[2]))));[127X[104X
    [4X[28X25999[128X[104X
    [4X[25Xgap>[125X [27Xsmall := Filtered([1..maxb],n->ForAll(maps,f->n^f>=n));[127X[104X
    [4X[28X[ 1, 7, 9, 11 ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThis  means that except ofÂ 1, only for [22Xn âˆˆ {7,9,11}[122X there is no product of 7
  mappings  [22XT_5^Â±[122X  which  maps  [22Xn[122X to a smaller integer. We check that also the
  forward  orbits  of these three integers containÂ 1 by successively computing
  preimages ofÂ 1:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XS := [1];; k := 0;;[127X[104X
    [4X[25Xgap>[125X [27Xrepeat[127X[104X
    [4X[25X>[125X [27X     S := Union(S,PreImage(T5m,S),PreImage(T5p,S));[127X[104X
    [4X[25X>[125X [27X     k := k+1;[127X[104X
    [4X[25X>[125X [27X   until IsSubset(S,small);[127X[104X
    [4X[25Xgap>[125X [27Xk;[127X[104X
    [4X[28X17[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().CollatzMapping);[110X  in order to assign
  the global variables defined in this section.[133X
  
  
  [1X7.19 [33X[0;0YThe free group of rank 2 and the modular group PSL(2,â„¤)[133X[101X
  
  [33X[0;0YThe  free  group  of rankÂ 2 embeds into RCWA(â„¤) -- in fact it embeds even in
  the  subgroup  which  is  generated by all class transpositions. An explicit
  embedding  can  be  constructed  by  transferring  the  construction  of the
  so-called  [21XSchottky  groups[121X  (cf.Â [dlH00], pageÂ 27) from PSL(2,â„‚) to RCWA(â„¤)
  (we use the notation from the cited book):[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XD := AllResidueClassesModulo(4);[127X[104X
    [4X[28X[ 0(4), 1(4), 2(4), 3(4) ][128X[104X
    [4X[25Xgap>[125X [27Xgamma1 := RepresentativeAction(RCWA(Integers),[127X[104X
    [4X[25X>[125X [27X                                  Difference(Integers,D[1]),D[2]);;[127X[104X
    [4X[25Xgap>[125X [27Xgamma2 := RepresentativeAction(RCWA(Integers),[127X[104X
    [4X[25X>[125X [27X                                  Difference(Integers,D[3]),D[4]);;[127X[104X
    [4X[25Xgap>[125X [27XF2 := Group(gamma1,gamma2);[127X[104X
    [4X[28X<rcwa group over Z with 2 generators>[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YWe can do some checks:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XX1 := Union(D{[1,2]});; X2 := Union(D{[3,4]});;[127X[104X
    [4X[25Xgap>[125X [27X    IsSubset(X1,X2^gamma1) and IsSubset(X1,X2^(gamma1^-1))[127X[104X
    [4X[25X>[125X [27X   and IsSubset(X2,X1^gamma2) and IsSubset(X2,X1^(gamma2^-1));[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe generators are products of 3 class transpositions, each:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XFactorization(gamma1);[127X[104X
    [4X[28X[ ClassTransposition(0,2,1,2), ClassTransposition(3,4,5,8),[128X[104X
    [4X[28X  ClassTransposition(0,2,1,8) ][128X[104X
    [4X[25Xgap>[125X [27XFactorization(gamma2);[127X[104X
    [4X[28X[ ClassTransposition(0,2,1,2), ClassTransposition(1,4,7,8),[128X[104X
    [4X[28X  ClassTransposition(0,2,3,8) ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe above construction is used by [2XIsomorphismRcwaGroup[102X ([14X3.1-4[114X) to embed free
  groups of any rankÂ [22Xâ‰¥ 2[122X.[133X
  
  [33X[0;0YWe  give another only slightly different representation of the free group of
  rankÂ 2.  We  verify  that  it  really  is  one  by  applying  the  so-called
  [13XTable-Tennis  Lemma[113X (see e.g.Â [dlH00], SectionÂ II.B.) to the infinite cyclic
  groups generated by the two generators and to the same two sets [10XX1[110X and [10XX2[110X as
  above:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xr1 := ClassTransposition(0,2,1,2)*ClassTransposition(0,2,1,4);;[127X[104X
    [4X[25Xgap>[125X [27Xr2 := ClassTransposition(0,2,1,2)*ClassTransposition(0,2,3,4);;[127X[104X
    [4X[25Xgap>[125X [27XF2 := Group(r1^2,r2^2);;[127X[104X
    [4X[25Xgap>[125X [27XList(GeneratorsOfGroup(F2),IsTame);[127X[104X
    [4X[28X[ false, false ][128X[104X
    [4X[25Xgap>[125X [27X    IsSubset(X1,X2^F2.1) and IsSubset(X1,X2^(F2.1^-1))[127X[104X
    [4X[25X>[125X [27X   and IsSubset(X2,X1^F2.2) and IsSubset(X2,X1^(F2.2^-1));[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27X[Sources(r1),Sinks(r1),Loops(r1)]; # compare with X1[127X[104X
    [4X[28X[ [ 0(4) ], [ 1(4) ], [ 0(4), 1(4) ] ][128X[104X
    [4X[25Xgap>[125X [27X[Sources(r2),Sinks(r2),Loops(r2)]; # compare with X2[127X[104X
    [4X[28X[ [ 2(4) ], [ 3(4) ], [ 2(4), 3(4) ] ][128X[104X
    [4X[25Xgap>[125X [27X   IsSubset(X1,Union(Sinks(r1))) and IsSubset(X1,Union(Sinks(r1^-1)))[127X[104X
    [4X[25X>[125X [27X  and IsSubset(X2,Union(Sinks(r2))) and IsSubset(X2,Union(Sinks(r2^-1)));[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsSubset(Union(Sinks(r1)),X2^F2.1) and[127X[104X
    [4X[25X>[125X [27X   IsSubset(Union(Sinks(r1^-1)),X2^(F2.1^-1));[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsSubset(Union(Sinks(r2)),X1^F2.2) and[127X[104X
    [4X[25X>[125X [27X   IsSubset(Union(Sinks(r2^-1)),X1^(F2.2^-1));[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YDrawing  the  transition  graphs  of  [10Xr1[110X  and  [10Xr2[110X  for modulusÂ 4 may help to
  understand what is actually done in this calculation. It is easy to see that
  the group generated by [10Xr1[110X andÂ [10Xr2[110X is [13Xnot[113X free:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XOrder(r1/r2);[127X[104X
    [4X[28X3[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe  modular group PSL(2,â„¤) embeds into CT(â„¤) as well. We give an embedding,
  and check that it really is one by applying the Table Tennis Lemma as above:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XPSL2Z := [127X[104X
    [4X[25X>[125X [27X     Group(ClassTransposition(0,3,1,3) * ClassTransposition(0,3,2,3),[127X[104X
    [4X[25X>[125X [27X           ClassTransposition(1,3,0,6) * ClassTransposition(2,3,3,6));;[127X[104X
    [4X[25Xgap>[125X [27XList(GeneratorsOfGroup(PSL2Z),Order);[127X[104X
    [4X[28X[ 3, 2 ][128X[104X
    [4X[25Xgap>[125X [27XX1 := Difference(Integers,ResidueClass(0,3));[127X[104X
    [4X[28XZ \ 0(3)[128X[104X
    [4X[25Xgap>[125X [27XX2 := ResidueClass(0,3);[127X[104X
    [4X[28X0(3)[128X[104X
    [4X[25Xgap>[125X [27XIsSubset(X1,X2^PSL2Z.1) and IsSubset(X1,X2^(PSL2Z.1^2));[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsSubset(X2,X1^PSL2Z.2);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YA  slightly  different  representation  of PSL(2,â„¤) can be obtained by using
  [5XRCWA[105X's  general  method for [10XIsomorphismRcwaGroup[110X for free products of finite
  groups:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XG := Image(IsomorphismRcwaGroup(FreeProduct(CyclicGroup(3),[127X[104X
    [4X[25X>[125X [27X                                               CyclicGroup(2))));[127X[104X
    [4X[28X<wild rcwa group over Z with 2 generators>[128X[104X
    [4X[25Xgap>[125X [27XList(GeneratorsOfGroup(G),Factorization);[127X[104X
    [4X[28X[ [ ClassTransposition(0,4,2,4), ClassTransposition(1,2,0,4) ],[128X[104X
    [4X[28X  [ ClassTransposition(0,2,1,2) ] ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YEnter  [10XAssignGlobals(RCWALoadExamples().F2_PSL2Z);[110X  in  order  to assign the
  global variables defined in this section.[133X
  
